{"items": [{"tags": ["sql", "join", "inner-join", "outer-join"], "owner": {"account_id": 2730, "reputation": 57605, "user_id": 3836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bb1cf0d02755d1ef421ee1eff457609?s=256&d=identicon&r=PG", "display_name": "Chris de Vries", "link": "https://stackoverflow.com/users/3836/chris-de-vries"}, "is_answered": true, "view_count": 2678504, "protected_date": 1342907514, "accepted_answer_id": 38578, "answer_count": 26, "score": 5267, "last_activity_date": 1729789289, "creation_date": 1220308566, "last_edit_date": 1661660808, "question_id": 38549, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/38549/what-is-the-difference-between-inner-join-and-outer-join", "title": "What is the difference between &quot;INNER JOIN&quot; and &quot;OUTER JOIN&quot;?", "body": "<p>Also, how do <code>LEFT OUTER JOIN</code>, <code>RIGHT OUTER JOIN</code>, and <code>FULL OUTER JOIN</code> fit in?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "sql-update", "dml"], "owner": {"account_id": 50576, "reputation": 45459, "user_id": 150939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.sstatic.net/3Q4Eb.jpg?s=256", "display_name": "jamesmhaley", "link": "https://stackoverflow.com/users/150939/jamesmhaley"}, "is_answered": true, "view_count": 5494733, "protected_date": 1365670275, "accepted_answer_id": 2334741, "answer_count": 40, "score": 4316, "last_activity_date": 1715303291, "creation_date": 1267108613, "last_edit_date": 1685021443, "question_id": 2334712, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/2334712/how-do-i-update-from-a-select-in-sql-server", "title": "How do I UPDATE from a SELECT in SQL Server?", "body": "<p>In <strong>SQL Server</strong>, it is possible to insert rows into a table with an <code>INSERT.. SELECT</code> statement:</p>\n<pre><code>INSERT INTO Table (col1, col2, col3)\nSELECT col1, col2, col3 \nFROM other_table \nWHERE sql = 'cool'\n</code></pre>\n<p>Is it also possible to <em>update</em> a table with <code>SELECT</code>? I have a temporary table containing the values and would like to update another table using those values. Perhaps something like this:</p>\n<pre><code>UPDATE Table SET col1, col2\nSELECT col1, col2 \nFROM other_table \nWHERE sql = 'cool'\nWHERE Table.id = other_table.id\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "sql-server-2005", "sql-server-2000"], "owner": {"account_id": 4728, "reputation": 34251, "user_id": 7241, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8446cdb9e7c661734023f7feab3cd071?s=256&d=identicon&r=PG", "display_name": "Mathias", "link": "https://stackoverflow.com/users/7241/mathias"}, "is_answered": true, "view_count": 3866588, "protected_date": 1377243891, "accepted_answer_id": 92123, "answer_count": 45, "score": 3311, "last_activity_date": 1733243105, "creation_date": 1221741004, "last_edit_date": 1703365710, "question_id": 92082, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/92082/how-to-add-a-column-with-a-default-value-to-an-existing-table-in-sql-server", "title": "How to add a column with a default value to an existing table in SQL Server?", "body": "<p>How can I add a column with a default value to an existing table in <a href=\"http://en.wikipedia.org/wiki/Microsoft_SQL_Server#Genesis\" rel=\"noreferrer\">SQL Server 2000</a> / <a href=\"http://en.wikipedia.org/wiki/Microsoft_SQL_Server#SQL_Server_2005\" rel=\"noreferrer\">SQL Server 2005</a>?</p>\n"}, {"tags": ["sql", "database", "performance", "indexing", "database-indexes"], "owner": {"account_id": 210, "reputation": 83981, "user_id": 264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49ee8012580951780d10ae8b12570e21?s=256&d=identicon&r=PG", "display_name": "Xenph Yan", "link": "https://stackoverflow.com/users/264/xenph-yan"}, "is_answered": true, "view_count": 1137351, "protected_date": 1310894405, "closed_date": 1646797358, "accepted_answer_id": 1130, "answer_count": 7, "score": 2898, "last_activity_date": 1646754151, "creation_date": 1217844432, "last_edit_date": 1532433557, "question_id": 1108, "link": "https://stackoverflow.com/questions/1108/how-does-database-indexing-work", "closed_reason": "Needs more focus", "title": "How does database indexing work?", "body": "<p>Given that indexing is so important as your data set increases in size, can someone explain how indexing works at a database-agnostic level?</p>\n\n<p>For information on queries to index a field, check out <a href=\"https://stackoverflow.com/questions/1156/\">How do I index a database column</a>.</p>\n"}, {"tags": ["php", "mysql", "sql", "security", "sql-injection"], "owner": {"account_id": 189075, "reputation": 26993, "user_id": 428190, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/980fe8340a6d455c77c13ed357851476?s=256&d=identicon&r=PG", "display_name": "Andrew G. Johnson", "link": "https://stackoverflow.com/users/428190/andrew-g-johnson"}, "is_answered": true, "view_count": 2211737, "protected_date": 1338976740, "accepted_answer_id": 60496, "answer_count": 27, "community_owned_date": 1352132329, "score": 2769, "locked_date": 1400621423, "last_activity_date": 1737836551, "creation_date": 1221263700, "last_edit_date": 1475309307, "question_id": 60174, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/60174/how-can-i-prevent-sql-injection-in-php", "title": "How can I prevent SQL injection in PHP?", "body": "<p>If user input is inserted without modification into an SQL query, then the application becomes vulnerable to <a href=\"https://stackoverflow.com/a/332367/\">SQL injection</a>, like in the following example:</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>$unsafe_variable = $_POST['user_input']; \n\nmysql_query(\"INSERT INTO `table` (`column`) VALUES ('$unsafe_variable')\");\n</code></pre>\n\n<p>That's because the user can input something like <code>value'); DROP TABLE table;--</code>, and the query becomes:</p>\n\n<pre><code>INSERT INTO `table` (`column`) VALUES('value'); DROP TABLE table;--')\n</code></pre>\n\n<p>What can be done to prevent this from happening?</p>\n"}, {"tags": ["sql", "duplicates"], "owner": {"account_id": 104708, "reputation": 36101, "user_id": 279776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9c368b605cfa34be3390a983b6bce441?s=256&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/279776/alex"}, "is_answered": true, "view_count": 3934787, "protected_date": 1437555329, "accepted_answer_id": 2594855, "answer_count": 35, "score": 2509, "last_activity_date": 1722824710, "creation_date": 1270664249, "last_edit_date": 1709149465, "question_id": 2594829, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/2594829/finding-duplicate-values-in-a-sql-table", "title": "Finding duplicate values in a SQL table", "body": "<p>It's easy to find duplicates with one field:</p>\n<pre><code>SELECT email, COUNT(email) \nFROM users\nGROUP BY email\nHAVING COUNT(email) &gt; 1\n</code></pre>\n<p>So if we have a table</p>\n<pre class=\"lang-none prettyprint-override\"><code>ID   NAME   EMAIL\n1    John   asd@asd.com\n2    Sam    asd@asd.com\n3    Tom    asd@asd.com\n4    Bob    bob@asd.com\n5    Tom    asd@asd.com\n</code></pre>\n<p>This query will give us John, Sam, Tom, Tom because they all have the same <code>email</code>.</p>\n<p>However, what I want is to get duplicates with the same <code>email</code> <strong>and</strong> <code>name</code>.</p>\n<p>That is, I want to get &quot;Tom&quot;, &quot;Tom&quot;.</p>\n<p>The reason I need this: I made a mistake, and allowed inserting duplicate <code>name</code> and <code>email</code> values. Now I need to remove/change the duplicates, so I need to <em>find</em> them first.</p>\n"}, {"tags": ["sql", "sql-server", "csv", "string-concatenation", "group-concat"], "owner": {"account_id": 13482, "reputation": 29536, "user_id": 27109, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4bd7f3bd0511e707347ba1e780279bc4?s=256&d=identicon&r=PG", "display_name": "JohnnyM", "link": "https://stackoverflow.com/users/27109/johnnym"}, "is_answered": true, "view_count": 3395317, "protected_date": 1312295534, "accepted_answer_id": 545672, "answer_count": 51, "score": 2444, "last_activity_date": 1737145819, "creation_date": 1223768999, "last_edit_date": 1629476147, "question_id": 194852, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/194852/how-to-concatenate-text-from-multiple-rows-into-a-single-text-string-in-sql-serv", "title": "How to concatenate text from multiple rows into a single text string in SQL Server", "body": "<p>Consider a database table holding names, with three rows:</p>\n<pre><code>Peter\nPaul\nMary\n</code></pre>\n<p>Is there an easy way to turn this into a single string of <code>Peter, Paul, Mary</code>?</p>\n"}, {"tags": ["sql", "date", "t-sql", "datetime", "sql-server-2008"], "owner": {"account_id": 3932, "reputation": 34828, "user_id": 5769, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db9af07e3524e2fa63530959d9948825?s=256&d=identicon&r=PG", "display_name": "Eddie Groves", "link": "https://stackoverflow.com/users/5769/eddie-groves"}, "is_answered": true, "view_count": 3861714, "protected_date": 1416433595, "accepted_answer_id": 113055, "answer_count": 47, "score": 2211, "last_activity_date": 1733245179, "creation_date": 1222054293, "last_edit_date": 1653362814, "question_id": 113045, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/113045/how-to-return-only-the-date-from-a-sql-server-datetime-datatype", "title": "How to return only the Date from a SQL Server DateTime datatype", "body": "<pre><code>SELECT GETDATE()\n</code></pre>\n\n<p>Returns: <code>2008-09-22 15:24:13.790</code></p>\n\n<p>I want that date part without the time part: <code>2008-09-22 00:00:00.000</code></p>\n\n<p>How can I get that?</p>\n"}, {"tags": ["mysql", "sql", "join", "inner-join", "outer-join"], "owner": {"account_id": 209097, "reputation": 33813, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.sstatic.net/eYTdm.jpg?s=256", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "is_answered": true, "view_count": 2236201, "protected_date": 1526564763, "closed_date": 1432481489, "answer_count": 2, "score": 2201, "last_activity_date": 1629972626, "creation_date": 1303146924, "last_edit_date": 1522045086, "question_id": 5706437, "link": "https://stackoverflow.com/questions/5706437/whats-the-difference-between-inner-join-left-join-right-join-and-full-join", "closed_reason": "Duplicate", "title": "What&#39;s the difference between INNER JOIN, LEFT JOIN, RIGHT JOIN and FULL JOIN?", "body": "<p>What's the difference between <code>INNER JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code> and <code>FULL JOIN</code> \nin <strong><em>MySQL</em></strong>?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "insert"], "owner": {"user_type": "does_not_exist", "display_name": "rits"}, "is_answered": true, "view_count": 3629938, "protected_date": 1508947426, "answer_count": 4, "score": 2073, "last_activity_date": 1736327483, "creation_date": 1232171754, "last_edit_date": 1571318745, "question_id": 452859, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/452859/inserting-multiple-rows-in-a-single-sql-query", "title": "Inserting multiple rows in a single SQL query?", "body": "<p>I have multiple set of data to insert at once, say 4 rows. My table has three columns: <code>Person</code>, <code>Id</code> and <code>Office</code>.</p>\n\n<pre><code>INSERT INTO MyTable VALUES (\"John\", 123, \"Lloyds Office\");\nINSERT INTO MyTable VALUES (\"Jane\", 124, \"Lloyds Office\");\nINSERT INTO MyTable VALUES (\"Billy\", 125, \"London Office\");\nINSERT INTO MyTable VALUES (\"Miranda\", 126, \"Bristol Office\");\n</code></pre>\n\n<p>Can I insert all 4 rows in a single SQL statement?</p>\n"}, {"tags": ["sql", "postgresql", "greatest-n-per-group"], "owner": {"account_id": 27199, "reputation": 154454, "user_id": 71522, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0e286ba0482e57904e89e753a4b36e6?s=256&d=identicon&r=PG", "display_name": "David Wolever", "link": "https://stackoverflow.com/users/71522/david-wolever"}, "is_answered": true, "view_count": 1859083, "protected_date": 1476956595, "accepted_answer_id": 3800572, "answer_count": 21, "score": 2050, "last_activity_date": 1729118484, "creation_date": 1285550602, "last_edit_date": 1692747845, "question_id": 3800551, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/3800551/select-first-row-in-each-group-by-group", "title": "Select first row in each GROUP BY group?", "body": "\n<p>I'd like to select the first row of each set of rows grouped with a <code>GROUP BY</code>.</p>\n<p>Specifically, if I've got a <code>purchases</code> table that looks like this:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM purchases;\n</code></pre>\n<p><strong>My Output:</strong></p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>customer</th>\n<th>total</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>Joe</td>\n<td>5</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Sally</td>\n<td>3</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Joe</td>\n<td>2</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Sally</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I'd like to query for the <code>id</code> of the largest purchase (<code>total</code>) made by each <code>customer</code>. Something like this:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT FIRST(id), customer, FIRST(total)\nFROM  purchases\nGROUP BY customer\nORDER BY total DESC;\n</code></pre>\n<p><strong>Expected Output:</strong></p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>FIRST(id)</th>\n<th>customer</th>\n<th>FIRST(total)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>Joe</td>\n<td>5</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Sally</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n</div>"}, {"tags": ["sql", "mongodb", "mongodb-query", "sql-like"], "owner": {"account_id": 137777, "reputation": 198188, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=256&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "is_answered": true, "view_count": 1851938, "protected_date": 1418858052, "accepted_answer_id": 3305687, "answer_count": 47, "score": 1972, "last_activity_date": 1699655515, "creation_date": 1279768761, "last_edit_date": 1620741610, "question_id": 3305561, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/3305561/how-to-query-mongodb-with-like", "title": "How to query MongoDB with &quot;like&quot;", "body": "<p>I want to query something with SQL's <code>like</code> query:</p>\n<pre><code>SELECT * FROM users  WHERE name LIKE '%m%'\n</code></pre>\n<p>How can I achieve the same in MongoDB? I can't find an operator for <code>like</code> in <a href=\"http://www.mongodb.org/display/DOCS/Advanced+Queries\" rel=\"noreferrer\">the documentation</a>.</p>\n"}, {"tags": ["sql", "sql-server", "naming-conventions"], "owner": {"account_id": 5433, "reputation": 51063, "user_id": 8741, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/feef9dda8bbe41e9def78c274a37f60c?s=256&d=identicon&r=PG", "display_name": "ProfK", "link": "https://stackoverflow.com/users/8741/profk"}, "is_answered": true, "view_count": 608450, "closed_date": 1381350256, "accepted_answer_id": 338433, "answer_count": 41, "community_owned_date": 1292935752, "score": 1888, "last_activity_date": 1685373647, "creation_date": 1228327770, "last_edit_date": 1509855099, "question_id": 338156, "link": "https://stackoverflow.com/questions/338156/table-naming-dilemma-singular-vs-plural-names", "closed_reason": "Opinion-based", "title": "Table Naming Dilemma: Singular vs. Plural Names", "body": "<p>Academia has it that table names should be the singular of the entity that they store attributes of.  </p>\n\n<p>I dislike any T-SQL that requires square brackets around names, but I have renamed a <code>Users</code> table to the singular, forever sentencing those using the table to sometimes have to use brackets.  </p>\n\n<p>My gut feel is that it is more correct to stay with the singular, but my gut feel is also that brackets indicate undesirables like column names with spaces in them etc.</p>\n\n<p>Should I stay, or should I go?</p>\n"}, {"tags": ["sql", "database", "syntax", "database-agnostic", "ansi-sql-92"], "owner": {"account_id": 197, "reputation": 42856, "user_id": 244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.sstatic.net/OPy8n.jpg?s=256", "display_name": "Claude Houle", "link": "https://stackoverflow.com/users/244/claude-houle"}, "is_answered": true, "view_count": 3543855, "protected_date": 1405638012, "accepted_answer_id": 25971, "answer_count": 28, "score": 1882, "last_activity_date": 1729895873, "creation_date": 1219668356, "last_edit_date": 1527608713, "question_id": 25969, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/25969/insert-into-values-select-from", "title": "Insert into ... values ( SELECT ... FROM ... )", "body": "<p>I am trying to <code>INSERT INTO</code> a table using the input from another table. Although this is entirely feasible for many database engines, I always seem to struggle to remember the correct syntax for the <code>SQL</code> engine of the day (<a href=\"http://en.wikipedia.org/wiki/MySQL\" rel=\"noreferrer\">MySQL</a>, <a href=\"http://en.wikipedia.org/wiki/Oracle_Database\" rel=\"noreferrer\">Oracle</a>, <a href=\"http://en.wikipedia.org/wiki/Microsoft_SQL_Server\" rel=\"noreferrer\">SQL Server</a>, <a href=\"http://en.wikipedia.org/wiki/IBM_Informix\" rel=\"noreferrer\">Informix</a>, and <a href=\"http://en.wikipedia.org/wiki/IBM_DB2\" rel=\"noreferrer\">DB2</a>).</p>\n\n<p>Is there a silver-bullet syntax coming from an SQL standard (for example, <a href=\"http://en.wikipedia.org/wiki/SQL-92\" rel=\"noreferrer\">SQL-92</a>) that would allow me to insert the values without worrying about the underlying database?</p>\n"}, {"tags": ["sql", "sql-server", "sql-server-2005", "t-sql", "stored-procedures"], "owner": {"account_id": 18618, "reputation": 21812, "user_id": 42829, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5132b8e37ef5b21cb72fa7fdb0b234bb?s=256&d=identicon&r=PG", "display_name": "Ferdeen", "link": "https://stackoverflow.com/users/42829/ferdeen"}, "is_answered": true, "view_count": 2640258, "protected_date": 1309983793, "answer_count": 35, "score": 1859, "last_activity_date": 1729092032, "creation_date": 1237286726, "last_edit_date": 1522044426, "question_id": 653714, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/653714/insert-results-of-a-stored-procedure-into-a-temporary-table", "title": "Insert results of a stored procedure into a temporary table", "body": "<p>How do I do a <code>SELECT * INTO [temp table] FROM [stored procedure]</code>? Not <code>FROM [Table]</code> and without defining <code>[temp table]</code>?</p>\n\n<p><code>Select</code> all data from <code>BusinessLine</code> into <code>tmpBusLine</code> works fine.</p>\n\n<pre><code>select *\ninto tmpBusLine\nfrom BusinessLine\n</code></pre>\n\n<p>I am trying the same, but using a <code>stored procedure</code> that returns data, is not quite the same.</p>\n\n<pre><code>select *\ninto tmpBusLine\nfrom\nexec getBusinessLineHistory '16 Mar 2009'\n</code></pre>\n\n<p><strong>Output message:</strong></p>\n\n<blockquote>\n  <p>Msg 156, Level 15, State 1, Line 2\n  Incorrect syntax near the keyword\n  'exec'.</p>\n</blockquote>\n\n<p>I have read several examples of creating a temporary table with the same structure as the output stored procedure, which works fine, but it would be nice to not supply any columns.</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "if-statement", "case"], "owner": {"account_id": 4366, "reputation": 29971, "user_id": 6522, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d896efd42eab17ca3cbce77a3515988?s=256&d=identicon&r=PG", "display_name": "Eric Labashosky", "link": "https://stackoverflow.com/users/6522/eric-labashosky"}, "is_answered": true, "view_count": 4716110, "protected_date": 1415343823, "accepted_answer_id": 63480, "answer_count": 30, "score": 1803, "last_activity_date": 1698816748, "creation_date": 1221489249, "last_edit_date": 1522044559, "question_id": 63447, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/63447/how-do-i-perform-an-if-then-in-an-sql-select", "title": "How do I perform an IF...THEN in an SQL SELECT?", "body": "<p>How do I perform an <code>IF...THEN</code> in an <code>SQL SELECT</code> statement?</p>\n\n<p>For example:</p>\n\n<pre><code>SELECT IF(Obsolete = 'N' OR InStock = 'Y' ? 1 : 0) AS Saleable, * FROM Product\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "t-sql", "system-tables"], "owner": {"account_id": 128750, "reputation": 29727, "user_id": 326821, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/04e06009d1b04f39bc31519821e63479?s=256&d=identicon&r=PG", "display_name": "gruber", "link": "https://stackoverflow.com/users/326821/gruber"}, "is_answered": true, "view_count": 4266784, "protected_date": 1493047472, "answer_count": 37, "score": 1799, "last_activity_date": 1730586484, "creation_date": 1296468746, "last_edit_date": 1706812086, "question_id": 4849652, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/4849652/find-all-tables-containing-column-with-specified-name", "title": "Find all tables containing column with specified name", "body": "<p>Is it possible to query for table names which contain columns being</p>\n<pre><code>LIKE '%myName%'\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "sql-server-2008", "inner-join", "sql-delete"], "owner": {"account_id": 1695449, "reputation": 18423, "user_id": 1556907, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/d64a60c8cf3e79e6b0cc98c33abdc29a?s=256&d=identicon&r=PG", "display_name": "nettoon493", "link": "https://stackoverflow.com/users/1556907/nettoon493"}, "is_answered": true, "view_count": 2231569, "protected_date": 1433194439, "accepted_answer_id": 16481475, "answer_count": 14, "score": 1783, "last_activity_date": 1633270059, "creation_date": 1368185901, "last_edit_date": 1633159060, "question_id": 16481379, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/16481379/how-can-i-delete-using-inner-join-with-sql-server", "title": "How can I delete using INNER JOIN with SQL Server?", "body": "<p>I want to <strong>delete</strong> using <code>INNER JOIN</code> in <strong>SQL Server 2008</strong>.</p>\n<p>But I get this error:</p>\n<blockquote>\n<p>Msg 156, Level 15, State 1, Line 15<br />\n<strong>Incorrect</strong> syntax near the <strong>keyword</strong> 'INNER'.</p>\n</blockquote>\n<p>My code:</p>\n<pre><code>DELETE \nFROM WorkRecord2 \nINNER JOIN Employee \n        ON EmployeeRun=EmployeeNo\nWHERE Company = '1' \n    AND Date = '2013-05-06'\n</code></pre>\n"}, {"tags": ["sql", "union", "union-all"], "owner": {"account_id": 2311, "reputation": 54992, "user_id": 3208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8092a4ad249c669a8e833fe49f4b4052?s=256&d=identicon&r=PG", "display_name": "Brian G", "link": "https://stackoverflow.com/users/3208/brian-g"}, "is_answered": true, "view_count": 1608378, "protected_date": 1398454989, "accepted_answer_id": 49928, "answer_count": 19, "score": 1719, "last_activity_date": 1721506946, "creation_date": 1220887173, "last_edit_date": 1522047021, "question_id": 49925, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/49925/what-is-the-difference-between-union-and-union-all", "title": "What is the difference between UNION and UNION ALL?", "body": "<p>What is the difference between <code>UNION</code> and <code>UNION ALL</code>?</p>\n"}, {"tags": ["mysql", "sql", "aggregate-functions", "greatest-n-per-group", "groupwise-maximum"], "owner": {"account_id": 25788, "reputation": 30242, "user_id": 66580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.sstatic.net/6ySFl.png?s=256", "display_name": "Majid Fouladpour", "link": "https://stackoverflow.com/users/66580/majid-fouladpour"}, "is_answered": true, "view_count": 2169235, "protected_date": 1444036919, "closed_date": 1553041150, "accepted_answer_id": 7745635, "answer_count": 27, "score": 1675, "last_activity_date": 1724952860, "creation_date": 1318448527, "last_edit_date": 1633339836, "question_id": 7745609, "link": "https://stackoverflow.com/questions/7745609/sql-select-only-rows-with-max-value-on-a-column", "closed_reason": "Duplicate", "title": "SQL select only rows with max value on a column", "body": "<p>I have this table for documents (simplified version here):</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>rev</th>\n<th>content</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>...</td>\n</tr>\n<tr>\n<td>2</td>\n<td>1</td>\n<td>...</td>\n</tr>\n<tr>\n<td>1</td>\n<td>2</td>\n<td>...</td>\n</tr>\n<tr>\n<td>1</td>\n<td>3</td>\n<td>...</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>How do I select one row per id and only the greatest rev?<br />\nWith the above data, the result should contain two rows: <code>[1, 3, ...]</code> and <code>[2, 1, ..]</code>. I'm using <em><strong>MySQL</strong></em>.</p>\n<p>Currently I use checks in the <code>while</code> loop to detect and over-write old revs from the resultset. But is this the only method to achieve the result? Isn't there a <strong>SQL</strong> solution?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "sql-server-2005", "sql-update"], "owner": {"account_id": 35098, "reputation": 21177, "user_id": 99297, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f8d2d0094ffe98f841e0b4bec8a5cc5?s=256&d=identicon&r=PG", "display_name": "Ant Swift", "link": "https://stackoverflow.com/users/99297/ant-swift"}, "is_answered": true, "view_count": 2319427, "protected_date": 1401294911, "accepted_answer_id": 1293347, "answer_count": 19, "score": 1674, "last_activity_date": 1698387134, "creation_date": 1250595607, "last_edit_date": 1586772315, "question_id": 1293330, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1293330/how-can-i-do-an-update-statement-with-join-in-sql-server", "title": "How can I do an UPDATE statement with JOIN in SQL Server?", "body": "<p>I need to update this table in <strong>SQL Server</strong> with data from its 'parent' table, see below:</p>\n\n<p><strong>Table: sale</strong></p>\n\n<pre><code>id (int)\nudid (int)\nassid (int)\n</code></pre>\n\n<p><strong>Table: ud</strong></p>\n\n<pre><code>id  (int)\nassid  (int)\n</code></pre>\n\n<p><code>sale.assid</code> contains the correct value to update <code>ud.assid</code>. </p>\n\n<p>What query will do this? I'm thinking of a <code>join</code> but I'm not sure if it's possible.</p>\n"}, {"tags": ["mysql", "sql", "auto-increment"], "owner": {"account_id": 919418, "reputation": 20745, "user_id": 3426825, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.sstatic.net/6DcUx.png?s=256", "display_name": "homerun", "link": "https://stackoverflow.com/users/3426825/homerun"}, "is_answered": true, "view_count": 1968757, "protected_date": 1399220597, "accepted_answer_id": 8923132, "answer_count": 28, "score": 1661, "last_activity_date": 1734305516, "creation_date": 1326962269, "last_edit_date": 1628188109, "question_id": 8923114, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/8923114/how-to-reset-auto-increment-in-mysql", "title": "How to reset AUTO_INCREMENT in MySQL", "body": "<p>How can I <em><strong>reset</strong></em> the <code>AUTO_INCREMENT</code> of a field?</p>\n<p>I want it to start counting from <code>1</code> again.</p>\n"}, {"tags": ["sql", "database", "tree", "relational-database", "hierarchical-data"], "owner": {"account_id": 215917, "reputation": 9961, "user_id": 470838, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ef8d0172b0c9f6542b9aaa08f15e4ec9?s=256&d=identicon&r=PG", "display_name": "orangepips", "link": "https://stackoverflow.com/users/470838/orangepips"}, "is_answered": true, "view_count": 345912, "protected_date": 1540786040, "answer_count": 8, "community_owned_date": 1289267320, "score": 1614, "last_activity_date": 1705939771, "creation_date": 1288311813, "last_edit_date": 1705939771, "question_id": 4048151, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/4048151/what-are-the-options-for-storing-hierarchical-data-in-a-relational-database", "title": "What are the options for storing hierarchical data in a relational database?", "body": "<p><strong>Good Overviews</strong></p>\n<p>Generally speaking, you're making a decision between fast read times (for example, nested set) or fast write times (adjacency list). Usually, you end up with a combination of the options below that best fit your needs. The following provides some in-depth reading:</p>\n<ul>\n<li><a href=\"http://vadimtropashko.wordpress.com/2008/08/09/one-more-nested-intervals-vs-adjacency-list-comparison/\" rel=\"noreferrer\">One more Nested Intervals vs. Adjacency List comparison</a>: <em>the best comparison</em> of Adjacency List, Materialized Path, Nested Set, and Nested Interval I've found.</li>\n<li><a href=\"http://www.slideshare.net/billkarwin/models-for-hierarchical-data\" rel=\"noreferrer\">Models for hierarchical data</a>: slides with good explanations of tradeoffs and example usage</li>\n<li><a href=\"http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/\" rel=\"noreferrer\">Representing hierarchies in MySQL</a>: very good overview of Nested Set in particular</li>\n<li><a href=\"http://troels.arvin.dk/db/rdbms/links/#hierarchical\" rel=\"noreferrer\">Hierarchical data in RDBMSs</a>: a most comprehensive and well-organized set of links I've seen, but not much in the way of explanation</li>\n</ul>\n<p><strong>Options</strong></p>\n<p>Ones I am aware of and general features:</p>\n<ol>\n<li><a href=\"http://en.wikipedia.org/wiki/Adjacency_list\" rel=\"noreferrer\">Adjacency List</a>:</li>\n</ol>\n<ul>\n<li>Columns: ID, ParentID</li>\n<li>Easy to implement.</li>\n<li>Cheap node moves, inserts, and deletes.</li>\n<li>Expensive to find the level, ancestry &amp; descendants, path</li>\n<li>Avoid N+1 via <a href=\"http://en.wikipedia.org/wiki/Common_table_expressions\" rel=\"noreferrer\">Common Table Expressions</a> in databases that support them</li>\n</ul>\n<ol start=\"2\">\n<li><a href=\"http://en.wikipedia.org/wiki/Nested_set_model\" rel=\"noreferrer\">Nested Set</a> (a.k.a <a href=\"https://www.caktusgroup.com/blog/2016/01/04/modified-preorder-tree-traversal-django/\" rel=\"noreferrer\">Modified Preorder Tree Traversal (MPTT)</a>)</li>\n</ol>\n<ul>\n<li>Columns: Left, Right</li>\n<li>Cheap ancestry, descendants</li>\n<li>Very expensive <code>O(n/2)</code> moves, inserts, deletes due to volatile encoding</li>\n</ul>\n<ol start=\"3\">\n<li><a href=\"https://www.informationweek.com/software/information-management/kimball-university-five-alternatives-for-better-employee-dimension-modeling/d/d-id/1082326\" rel=\"noreferrer\">Bridge Table</a> (a.k.a. <a href=\"http://dirtsimple.org/2010/11/simplest-way-to-do-tree-based-queries.html\" rel=\"noreferrer\">Closure Table /w triggers</a>)</li>\n</ol>\n<ul>\n<li>Uses separate join table with ancestor, descendant, depth (optional)</li>\n<li>Cheap ancestry and descendants</li>\n<li>Writes costs <code>O(log n)</code> (size of the subtree) for insert, updates, deletes</li>\n<li>Normalized encoding: good for RDBMS statistics &amp; query planner in joins</li>\n<li>Requires multiple rows per node</li>\n</ul>\n<ol start=\"4\">\n<li><a href=\"https://web.archive.org/web/20150909165001/http://www.ferdychristant.com/blog//articles/DOMM-7QJPM7\" rel=\"noreferrer\">Lineage Column</a> (a.k.a. <a href=\"http://communities.bmc.com/communities/docs/DOC-9902\" rel=\"noreferrer\">Materialized Path</a>, Path Enumeration)</li>\n</ol>\n<ul>\n<li>Column: lineage (e.g. /parent/child/grandchild/etc...)</li>\n<li>Cheap descendants via prefix query (e.g. <code>LEFT(lineage, #) = '/enumerated/path'</code>)</li>\n<li>Writes costs <code>O(log n)</code> (size of the subtree) for insert, updates, deletes</li>\n<li>Non-relational: relies on Array datatype or serialized string format</li>\n</ul>\n<ol start=\"5\">\n<li><a href=\"https://sigmodrecord.org/publications/sigmodRecord/0506/p47-article-tropashko.pdf\" rel=\"noreferrer\">Nested Intervals</a></li>\n</ol>\n<ul>\n<li>Like nested set, but with real/float/decimal so that the encoding isn't volatile (inexpensive move/insert/delete)</li>\n<li>Has real/float/decimal representation/precision issues</li>\n<li><a href=\"http://vadimtropashko.files.wordpress.com/2011/07/ch5.pdf\" rel=\"noreferrer\">Matrix encoding variant</a> adds ancestor encoding (materialized path) for &quot;free&quot;, but with the added trickiness of linear algebra.</li>\n</ul>\n<ol start=\"6\">\n<li><a href=\"http://evolt.org/node/4047\" rel=\"noreferrer\">Flat Table</a></li>\n</ol>\n<ul>\n<li>A modified Adjacency List that adds a Level and Rank (e.g. ordering) column to each record.</li>\n<li>Cheap to iterate/paginate over</li>\n<li>Expensive move and delete</li>\n<li>Good Use: threaded discussion - forums / blog comments</li>\n</ul>\n<ol start=\"7\">\n<li><a href=\"https://stackoverflow.com/a/6802687/684229\">Multiple lineage columns</a></li>\n</ol>\n<ul>\n<li>Columns: one for each lineage level, refers to all the parents up to the root, levels down from the item's level are set to NULL</li>\n<li>Cheap ancestors, descendants, level</li>\n<li>Cheap insert, delete, move of the leaves</li>\n<li>Expensive insert, delete, move of the internal nodes</li>\n<li>Hard limit to how deep the hierarchy can be</li>\n</ul>\n<p><strong>Database Specific Notes</strong></p>\n<p><em>MySQL/MariaDB</em></p>\n<ul>\n<li><strike><a href=\"http://explainextended.com/2009/09/29/adjacency-list-vs-nested-sets-mysql/\" rel=\"noreferrer\">Use session variables for Adjacency List</a></strike></li>\n<li>Use CTEs in MySQL 8.0 or MariaDB 10.2</li>\n</ul>\n<p><em>Oracle</em></p>\n<ul>\n<li>Use <a href=\"http://www.ypl.com/oracle/sql/hierarchical_queries/html_deep/index.html\" rel=\"noreferrer\">CONNECT BY</a> to traverse Adjacency Lists</li>\n</ul>\n<p><em>PostgreSQL</em></p>\n<ul>\n<li><a href=\"http://www.postgresql.org/docs/current/static/ltree.html\" rel=\"noreferrer\">ltree datatype</a> for Materialized Path</li>\n</ul>\n<p><em>SQL Server</em></p>\n<ul>\n<li><a href=\"http://msdn.microsoft.com/en-us/magazine/cc794278.aspx\" rel=\"noreferrer\">General summary</a></li>\n<li>2008 offers <a href=\"http://msdn.microsoft.com/en-us/library/bb677290.aspx\" rel=\"noreferrer\">HierarchyId</a> data type that appears to help with the Lineage Column approach and expand the depth that can be represented.</li>\n</ul>\n"}, {"tags": ["sql", "group-by", "multiple-columns"], "owner": {"account_id": 40617, "reputation": 60691, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=256&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "is_answered": true, "view_count": 2290675, "accepted_answer_id": 2421441, "answer_count": 4, "score": 1532, "last_activity_date": 1724048282, "creation_date": 1268262683, "last_edit_date": 1595429254, "question_id": 2421388, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/2421388/using-group-by-on-multiple-columns", "title": "Using group by on multiple columns", "body": "<p>I understand the point of <code>GROUP BY x</code>.</p>\n<p>But how does <code>GROUP BY x, y</code> work, and what does it mean?</p>\n"}, {"tags": ["mysql", "sql", "concatenation", "group-concat"], "owner": {"account_id": 8332, "reputation": 32374, "user_id": 14966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e039d6aad8ab7ebe721efb30188dc6c?s=256&d=identicon&r=PG", "display_name": "Dean Rather", "link": "https://stackoverflow.com/users/14966/dean-rather"}, "is_answered": true, "view_count": 923583, "protected_date": 1314755646, "accepted_answer_id": 276949, "answer_count": 16, "score": 1497, "last_activity_date": 1679080788, "creation_date": 1226284466, "last_edit_date": 1587295364, "question_id": 276927, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/276927/can-i-concatenate-multiple-mysql-rows-into-one-field", "title": "Can I concatenate multiple MySQL rows into one field?", "body": "<p>Using <code>MySQL</code>, I can do something like:</p>\n\n<pre><code>SELECT hobbies FROM peoples_hobbies WHERE person_id = 5;\n</code></pre>\n\n<p><strong>My Output:</strong></p>\n\n<pre><code>shopping\nfishing\ncoding\n</code></pre>\n\n<p>but instead I just want 1 row, 1 col:</p>\n\n<p><strong>Expected Output:</strong></p>\n\n<pre><code>shopping, fishing, coding\n</code></pre>\n\n<p>The reason is that I'm selecting multiple values from multiple tables, and after all the joins I've got a lot more rows than I'd like.</p>\n\n<p>I've looked for a function on <a href=\"http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws\" rel=\"noreferrer\">MySQL Doc</a> and it doesn't look like the <code>CONCAT</code> or <code>CONCAT_WS</code> functions accept result sets.</p>\n\n<p>So does anyone here know how to do this?</p>\n"}, {"tags": ["sql", "sql-server", "join", "inner-join"], "owner": {"account_id": 7784, "reputation": 164281, "user_id": 13627, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3aa80c54202b85c3c4819a764e20d974?s=256&d=identicon&r=PG", "display_name": "driis", "link": "https://stackoverflow.com/users/13627/driis"}, "is_answered": true, "view_count": 1045143, "protected_date": 1337098090, "accepted_answer_id": 565640, "answer_count": 6, "score": 1468, "last_activity_date": 1712281725, "creation_date": 1235054849, "last_edit_date": 1712281725, "question_id": 565620, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/565620/what-is-the-difference-between-join-and-inner-join", "title": "What is the difference between JOIN and INNER JOIN?", "body": "<p>Both these joins will give me the same results:</p>\n\n<pre><code>SELECT * FROM table JOIN otherTable ON table.ID = otherTable.FK\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>SELECT * FROM table INNER JOIN otherTable ON table.ID = otherTable.FK\n</code></pre>\n\n<p>Is there any difference between the statements in performance or otherwise? </p>\n\n<p>Does it differ between different <strong>SQL</strong> implementations? </p>\n"}, {"tags": ["sql", "sqlite", "database-schema"], "owner": {"account_id": 746, "reputation": 51751, "user_id": 974, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3d7e0433078e5d9b54fb90edf7bd10a3?s=256&d=identicon&r=PG", "display_name": "izb", "link": "https://stackoverflow.com/users/974/izb"}, "is_answered": true, "view_count": 1362682, "protected_date": 1316302266, "accepted_answer_id": 83195, "answer_count": 19, "score": 1425, "last_activity_date": 1714407513, "creation_date": 1221656393, "last_edit_date": 1689327358, "question_id": 82875, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/82875/how-can-i-list-the-tables-in-a-sqlite-database-file-that-was-opened-with-attach", "title": "How can I list the tables in a SQLite database file that was opened with ATTACH?", "body": "<p>What SQL can be used to list the tables, and the rows within those tables in an SQLite database file \u2013 once I have attached it with the <code>ATTACH</code> command on the <code>sqlite3</code> command line tool?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "delimiter", "single-quotes"], "owner": {"account_id": 50514, "reputation": 15786, "user_id": 150703, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d631ff3e8e38cc28e0f3cc8ccb28f0c5?s=256&d=identicon&r=PG", "display_name": "tim_wonil", "link": "https://stackoverflow.com/users/150703/tim-wonil"}, "is_answered": true, "view_count": 1873697, "protected_date": 1576851340, "accepted_answer_id": 1586588, "answer_count": 15, "score": 1419, "last_activity_date": 1714751788, "creation_date": 1255915102, "last_edit_date": 1625633407, "question_id": 1586560, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1586560/how-do-i-escape-a-single-quote-in-sql-server", "title": "How do I escape a single quote in SQL Server?", "body": "<p>I am trying to <code>insert</code> some text data into a table in SQL Server 9.</p>\n<p>The text includes a single quote <code>'</code>.</p>\n<p>How do I escape that?</p>\n<p>I tried using two single quotes, but it threw me some errors.</p>\n<p>eg. <code>insert into my_table values('hi, my name''s tim.');</code></p>\n"}, {"tags": ["sql", "sql-server", "t-sql"], "owner": {"account_id": 1190, "reputation": 498904, "user_id": 1583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.sstatic.net/Au4eT.png?s=256", "display_name": "Oded", "link": "https://stackoverflow.com/users/1583/oded"}, "is_answered": true, "view_count": 1261441, "protected_date": 1446072000, "accepted_answer_id": 42655, "answer_count": 15, "score": 1386, "last_activity_date": 1703315822, "creation_date": 1220477522, "last_edit_date": 1703315822, "question_id": 42648, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/42648/how-to-get-the-identity-of-an-inserted-row", "title": "How to get the identity of an inserted row?", "body": "<p>How can I get the <code>IDENTITY</code> of an inserted row?</p>\n<p>I know about <code>@@IDENTITY</code> and <code>IDENT_CURRENT</code> and <code>SCOPE_IDENTITY</code>, but don't understand the implications or impacts attached to each. How do these differ, and when would each be used?</p>\n"}, {"tags": ["sql", "oracle-database", "pagination", "sql-limit"], "owner": {"account_id": 22129, "reputation": 16700, "user_id": 54320, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc12d78962944a9cf1b4e3bd08dc7589?s=256&d=identicon&r=PG", "display_name": "Mathieu Longtin", "link": "https://stackoverflow.com/users/54320/mathieu-longtin"}, "is_answered": true, "view_count": 2556447, "protected_date": 1366530079, "accepted_answer_id": 470571, "answer_count": 16, "score": 1378, "last_activity_date": 1713547097, "creation_date": 1232653723, "last_edit_date": 1611225347, "question_id": 470542, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/470542/how-do-i-limit-the-number-of-rows-returned-by-an-oracle-query-after-ordering", "title": "How do I limit the number of rows returned by an Oracle query after ordering?", "body": "<p>Is there a way to make an <code>Oracle</code> query behave like it contains a MySQL <code>limit</code> clause?</p>\n<p>In MySQL, I can do this:</p>\n<pre><code>select * \nfrom sometable\norder by name\nlimit 20,10\n</code></pre>\n<p>to get the 21st to the 30th rows (skip the first 20, give the next 10). The rows are selected after the <code>order by</code>, so it really starts on the 20th name alphabetically.</p>\n<p>In Oracle, the only thing people mention is the <code>rownum</code> pseudo-column, but it is evaluated <em>before</em> <code>order by</code>, which means this:</p>\n<pre><code>select * \nfrom sometable\nwhere rownum &lt;= 10\norder by name\n</code></pre>\n<p>will return a random set of ten rows ordered by name, which is not usually what I want. It also doesn't allow for specifying an offset.</p>\n"}, {"tags": ["mysql", "sql", "group-by", "greatest-n-per-group", "groupwise-maximum"], "owner": {"account_id": 13612, "reputation": 27466, "user_id": 27474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/91160e88d86db6328f3e81313ae500c6?s=256&d=identicon&r=PG", "display_name": "Vijay Dev", "link": "https://stackoverflow.com/users/27474/vijay-dev"}, "is_answered": true, "view_count": 1230130, "protected_date": 1333101504, "accepted_answer_id": 1313293, "answer_count": 34, "score": 1350, "last_activity_date": 1692035544, "creation_date": 1250874244, "last_edit_date": 1645542820, "question_id": 1313120, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1313120/retrieving-the-last-record-in-each-group-mysql", "title": "Retrieving the last record in each group - MySQL", "body": "<p>There is a table <code>messages</code> that contains data as shown below:</p>\n\n<pre><code>Id   Name   Other_Columns\n-------------------------\n1    A       A_data_1\n2    A       A_data_2\n3    A       A_data_3\n4    B       B_data_1\n5    B       B_data_2\n6    C       C_data_1\n</code></pre>\n\n<p>If I run a query <code>select * from messages group by name</code>, I will get the result as:</p>\n\n<pre><code>1    A       A_data_1\n4    B       B_data_1\n6    C       C_data_1\n</code></pre>\n\n<p>What query will return the following result?</p>\n\n<pre><code>3    A       A_data_3\n5    B       B_data_2\n6    C       C_data_1\n</code></pre>\n\n<p>That is, the last record in each group should be returned.</p>\n\n<p>At present, this is the query that I use:</p>\n\n<pre><code>SELECT\n  *\nFROM (SELECT\n  *\nFROM messages\nORDER BY id DESC) AS x\nGROUP BY name\n</code></pre>\n\n<p>But this looks highly inefficient. Any other ways to achieve the same result?</p>\n"}, {"tags": ["sql", "sql-server", "select", "join", "sql-update"], "owner": {"user_type": "does_not_exist", "display_name": "Boerseun"}, "is_answered": true, "view_count": 2704803, "protected_date": 1285932695, "answer_count": 29, "score": 1227, "last_activity_date": 1671794417, "creation_date": 1224659643, "last_edit_date": 1653324605, "question_id": 224732, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/224732/sql-update-from-one-table-to-another-based-on-a-id-match", "title": "SQL Update from One Table to Another Based on a ID Match", "body": "<p>I have a database with <code>account numbers</code> and <code>card numbers</code>. I match these to a file to <code>update</code> any card numbers to the account number so that I am only working with account numbers.</p>\n<p>I created a view linking the table to the account/card database to return the <code>Table ID</code> and the related account number, and now I need to update those records where the ID matches the Account Number.</p>\n<p>This is the <code>Sales_Import</code> table, where the <code>account number</code> field needs to be updated:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>LeadID</th>\n<th>AccountNumber</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>147</td>\n<td>5807811235</td>\n</tr>\n<tr>\n<td>150</td>\n<td>5807811326</td>\n</tr>\n<tr>\n<td>185</td>\n<td>7006100100007267039</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>And this is the <code>RetrieveAccountNumber</code> table, where I need to update from:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>LeadID</th>\n<th>AccountNumber</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>147</td>\n<td>7006100100007266957</td>\n</tr>\n<tr>\n<td>150</td>\n<td>7006100100007267039</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I tried the below, but no luck so far:</p>\n<pre><code>UPDATE [Sales_Lead].[dbo].[Sales_Import] \nSET    [AccountNumber] = (SELECT RetrieveAccountNumber.AccountNumber \n                          FROM   RetrieveAccountNumber \n                          WHERE  [Sales_Lead].[dbo].[Sales_Import]. LeadID = \n                                                RetrieveAccountNumber.LeadID) \n</code></pre>\n<p>It updates the card numbers to account numbers, but the account numbers get replaced by <code>NULL</code></p>\n"}, {"tags": ["sql", "oracle-database"], "owner": {"account_id": 969, "reputation": 15912, "user_id": 1287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bcbd84f218522df196d8c732d099014c?s=256&d=identicon&r=PG", "display_name": "vitule", "link": "https://stackoverflow.com/users/1287/vitule"}, "is_answered": true, "view_count": 2478557, "protected_date": 1292067373, "accepted_answer_id": 205746, "answer_count": 25, "score": 1225, "last_activity_date": 1722132075, "creation_date": 1224093289, "last_edit_date": 1448611031, "question_id": 205736, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/205736/get-list-of-all-tables-in-oracle", "title": "Get list of all tables in Oracle?", "body": "<p>How do I query an Oracle database to display the names of all tables in it?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql"], "owner": {"user_type": "does_not_exist", "display_name": "uu\u0250\u026f\u01dd\u0283\u01dds"}, "is_answered": true, "view_count": 1710435, "protected_date": 1638789492, "answer_count": 47, "score": 1200, "last_activity_date": 1728492059, "creation_date": 1239182128, "last_edit_date": 1627113431, "question_id": 729197, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/729197/exclude-a-column-using-select-except-columna-from-tablea", "title": "Exclude a column using SELECT * [except columnA] FROM tableA?", "body": "<p>We all know that to select all columns from a table, we can use</p>\n\n<pre><code>SELECT * FROM tableA\n</code></pre>\n\n<p>Is there a way to exclude column(s) from a table without specifying all the columns?</p>\n\n<pre><code>SELECT * [except columnA] FROM tableA\n</code></pre>\n\n<p>The only way that I know is to manually specify all the columns and exclude the unwanted column. This is really time consuming so I'm looking for ways to save time and effort on this, as well as future maintenance should the table has more/less columns.</p>\n"}, {"tags": ["mysql", "sql", "insert-update", "upsert"], "owner": {"account_id": 192945, "reputation": 14677, "user_id": 434375, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2ea63a0c64729d16610261e71f488e9?s=256&d=identicon&r=PG", "display_name": "Keshan", "link": "https://stackoverflow.com/users/434375/keshan"}, "is_answered": true, "view_count": 1354474, "protected_date": 1441103685, "accepted_answer_id": 4205207, "answer_count": 13, "score": 1180, "last_activity_date": 1701899048, "creation_date": 1290002932, "last_edit_date": 1597236951, "question_id": 4205181, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/4205181/insert-into-a-mysql-table-or-update-if-exists", "title": "Insert into a MySQL table or update if exists", "body": "<p>I want to add a row to a database table, but if a row exists with the same unique key I want to update the row.</p>\n<p>For example:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO table_name (ID, NAME, AGE) VALUES(1, &quot;A&quot;, 19);\n</code></pre>\n<p>Let\u2019s say the unique key is <code>ID</code>, and in my <strong>Database</strong>, there is a row with <code>ID = 1</code>. In that case, I want to update that row with these values. Normally this gives an error.<br />\nIf I use <code>INSERT IGNORE</code> it will ignore the error, but it still won\u2019t update.</p>\n"}, {"tags": ["sql", "sql-server", "performance", "t-sql", "cross-apply"], "owner": {"account_id": 38895, "reputation": 39017, "user_id": 111934, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8e43779c997d8ba388efa39e0d105eba?s=256&d=identicon&r=PG", "display_name": "Jeff Meatball Yang", "link": "https://stackoverflow.com/users/111934/jeff-meatball-yang"}, "is_answered": true, "view_count": 1058152, "accepted_answer_id": 1139231, "answer_count": 15, "score": 1152, "last_activity_date": 1633725746, "creation_date": 1247766141, "last_edit_date": 1623137338, "question_id": 1139160, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1139160/when-should-i-use-cross-apply-over-inner-join", "title": "When should I use CROSS APPLY over INNER JOIN?", "body": "<p>What is the main purpose of using <a href=\"http://technet.microsoft.com/en-us/library/ms175156.aspx\" rel=\"noreferrer\">CROSS APPLY</a>?</p>\n\n<p>I have read (vaguely, through posts on the Internet) that <code>cross apply</code> can be more efficient when selecting over large data sets if you are partitioning. (Paging comes to mind)</p>\n\n<p>I also know that <code>CROSS APPLY</code> doesn't require a UDF as the right-table.</p>\n\n<p>In most <code>INNER JOIN</code> queries (one-to-many relationships), I could rewrite them to use <code>CROSS APPLY</code>, but they always give me equivalent execution plans. </p>\n\n<p>Can anyone give me a good example of when <code>CROSS APPLY</code> makes a difference in those cases where <code>INNER JOIN</code> will work as well?</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here's a trivial example, where the execution plans are exactly the same.  (Show me one where they differ and where <code>cross apply</code> is faster/more efficient)</p>\n\n<pre><code>create table Company (\n    companyId int identity(1,1)\n,   companyName varchar(100)\n,   zipcode varchar(10) \n,   constraint PK_Company primary key (companyId)\n)\nGO\n\ncreate table Person (\n    personId int identity(1,1)\n,   personName varchar(100)\n,   companyId int\n,   constraint FK_Person_CompanyId foreign key (companyId) references dbo.Company(companyId)\n,   constraint PK_Person primary key (personId)\n)\nGO\n\ninsert Company\nselect 'ABC Company', '19808' union\nselect 'XYZ Company', '08534' union\nselect '123 Company', '10016'\n\n\ninsert Person\nselect 'Alan', 1 union\nselect 'Bobby', 1 union\nselect 'Chris', 1 union\nselect 'Xavier', 2 union\nselect 'Yoshi', 2 union\nselect 'Zambrano', 2 union\nselect 'Player 1', 3 union\nselect 'Player 2', 3 union\nselect 'Player 3', 3 \n\n\n/* using CROSS APPLY */\nselect *\nfrom Person p\ncross apply (\n    select *\n    from Company c\n    where p.companyid = c.companyId\n) Czip\n\n/* the equivalent query using INNER JOIN */\nselect *\nfrom Person p\ninner join Company c on p.companyid = c.companyId\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "stored-procedures"], "owner": {"account_id": 431289, "reputation": 12733, "user_id": 815244, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.sstatic.net/frgTL.jpg?s=256", "display_name": "DharaPPatel", "link": "https://stackoverflow.com/users/815244/dharappatel"}, "is_answered": true, "view_count": 2653178, "protected_date": 1523063484, "accepted_answer_id": 14704157, "answer_count": 25, "score": 1146, "last_activity_date": 1721143969, "creation_date": 1360056639, "last_edit_date": 1624862614, "question_id": 14704105, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/14704105/search-text-in-stored-procedure-in-sql-server", "title": "Search text in stored procedure in SQL Server", "body": "<p>I want to search a text from all my database stored procedures. I use the below SQL:</p>\n<pre><code>SELECT DISTINCT\n       o.name AS Object_Name,\n       o.type_desc\nFROM sys.sql_modules m\n       INNER JOIN\n       sys.objects o\n         ON m.object_id = o.object_id\nWHERE m.definition Like '%[ABD]%';\n</code></pre>\n<p>I want to search for <code>[ABD]</code> in all stored procedures including square brackets, but it's not giving the proper result. How can I change my query to achieve this?</p>\n"}, {"tags": ["sql", "postgresql", "csv", "postgresql-copy"], "owner": {"account_id": 35939, "reputation": 39826, "user_id": 102181, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8bf03194a8ab9e09c26a38ee0404315?s=256&d=identicon&r=PG", "display_name": "Hoff", "link": "https://stackoverflow.com/users/102181/hoff"}, "is_answered": true, "view_count": 984462, "protected_date": 1678105898, "accepted_answer_id": 1517692, "answer_count": 21, "score": 1143, "last_activity_date": 1694117727, "creation_date": 1254697131, "last_edit_date": 1491764423, "question_id": 1517635, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/1517635/save-pl-pgsql-output-from-postgresql-to-a-csv-file", "title": "Save PL/pgSQL output from PostgreSQL to a CSV file", "body": "<p>What is the easiest way to save PL/pgSQL output from a PostgreSQL database to a CSV file? </p>\n\n<p>I'm using PostgreSQL 8.4 with pgAdmin III and PSQL plugin where I run queries from.</p>\n"}, {"tags": ["sql", "sql-server-2008", "parameters"], "owner": {"account_id": 1, "reputation": 63949, "user_id": 1, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51d623f33f8b83095db84ff35e15dbe8?s=256&d=identicon&r=PG", "display_name": "Jeff Atwood", "link": "https://stackoverflow.com/users/1/jeff-atwood"}, "is_answered": true, "view_count": 453717, "protected_date": 1348143424, "accepted_answer_id": 337817, "answer_count": 41, "score": 1143, "last_activity_date": 1705261821, "creation_date": 1228321003, "last_edit_date": 1654094870, "question_id": 337704, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/337704/parameterize-an-sql-in-clause", "title": "Parameterize an SQL IN clause", "body": "<p>How do I parameterize a query containing an <code>IN</code> clause with a variable number of arguments, like this one?</p>\n\n<pre><code>SELECT * FROM Tags \nWHERE Name IN ('ruby','rails','scruffy','rubyonrails')\nORDER BY Count DESC\n</code></pre>\n\n<p>In this query, the number of arguments could be anywhere from 1 to 5.</p>\n\n<p>I would prefer not to use a dedicated stored procedure for this (or XML), but if there is some elegant way specific to <a href=\"http://en.wikipedia.org/wiki/Microsoft_SQL_Server#SQL_Server_2008\" rel=\"noreferrer\">SQL Server 2008</a>, I am open to that.</p>\n"}, {"tags": ["sql", "mysql", "join", "inner-join"], "owner": {"account_id": 38572, "reputation": 16612, "user_id": 110800, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/65228c7f0e87e7890fe82e68296b805d?s=256&d=identicon&r=PG", "display_name": "JCCyC", "link": "https://stackoverflow.com/users/110800/jccyc"}, "is_answered": true, "view_count": 737697, "protected_date": 1444036899, "accepted_answer_id": 1018825, "answer_count": 12, "score": 1136, "last_activity_date": 1614192599, "creation_date": 1245428184, "last_edit_date": 1523721530, "question_id": 1018822, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/1018822/inner-join-on-vs-where-clause", "title": "INNER JOIN ON vs WHERE clause", "body": "<p>For simplicity, assume all relevant fields are <code>NOT NULL</code>.</p>\n\n<p>You can do:</p>\n\n<pre><code>SELECT\n    table1.this, table2.that, table2.somethingelse\nFROM\n    table1, table2\nWHERE\n    table1.foreignkey = table2.primarykey\n    AND (some other conditions)\n</code></pre>\n\n<p>Or else:</p>\n\n<pre><code>SELECT\n    table1.this, table2.that, table2.somethingelse\nFROM\n    table1 INNER JOIN table2\n    ON table1.foreignkey = table2.primarykey\nWHERE\n    (some other conditions)\n</code></pre>\n\n<p>Do these two work on the same way in <code>MySQL</code>?</p>\n"}, {"tags": ["sql", "mysql", "subquery", "join"], "owner": {"account_id": 107389, "reputation": 157828, "user_id": 285587, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.sstatic.net/uhHvv.jpg?s=256", "display_name": "Your Common Sense", "link": "https://stackoverflow.com/users/285587/your-common-sense"}, "is_answered": true, "view_count": 665566, "protected_date": 1678105934, "accepted_answer_id": 39588846, "answer_count": 20, "score": 1135, "last_activity_date": 1629752998, "creation_date": 1270448542, "last_edit_date": 1541268025, "question_id": 2577174, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/2577174/join-vs-sub-query", "title": "Join vs. sub-query", "body": "<p>I am an old-school MySQL user and have always preferred <code>JOIN</code> over sub-query. But nowadays everyone uses sub-query, and I hate it; I don't know why.   </p>\n\n<p>I lack the theoretical knowledge to judge for myself if there is any difference. Is a sub-query as good as a <code>JOIN</code> and therefore is there nothing to worry about?</p>\n"}, {"tags": ["sql", "mysql", "sql-insert", "primary-key", "unique-constraint"], "owner": {"account_id": 3110, "reputation": 33435, "user_id": 4418, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.sstatic.net/sQFX6.jpg?s=256", "display_name": "warren", "link": "https://stackoverflow.com/users/4418/warren"}, "is_answered": true, "view_count": 1159195, "protected_date": 1515548627, "accepted_answer_id": 1361368, "answer_count": 12, "score": 1102, "last_activity_date": 1708412844, "creation_date": 1251795401, "last_edit_date": 1708155336, "question_id": 1361340, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1361340/how-can-i-do-insert-if-not-exists-in-mysql", "title": "How can I do &#39;insert if not exists&#39; in MySQL?", "body": "<p>I started by googling and found the article <em><a href=\"http://www.xaprb.com/blog/2005/09/25/insert-if-not-exists-queries-in-mysql/\" rel=\"noreferrer\">How to write INSERT if NOT EXISTS queries in standard SQL</a></em> which talks about mutex tables.</p>\n<p>I have a table with ~14 million records. If I want to add more data in the same format, is there a way to ensure the record I want to insert does not already exist <strong>without using a pair of queries</strong> (i.e., one query to check and one to insert is the result set is empty)?</p>\n<p>Does a <code>unique</code> constraint on a field guarantee the <code>insert</code> will fail if it's already there?</p>\n<p>It seems that with <em>merely</em> a constraint, when I issue the insert via PHP, the script croaks.</p>\n"}, {"tags": ["sql", "sql-server", "sql-server-2008", "t-sql"], "owner": {"account_id": 24125, "reputation": 26517, "user_id": 61156, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d41619db953932c92e0eacff01f8263?s=256&d=identicon&r=PG", "display_name": "odiseh", "link": "https://stackoverflow.com/users/61156/odiseh"}, "is_answered": true, "view_count": 3266910, "protected_date": 1391875217, "accepted_answer_id": 1054988, "answer_count": 24, "score": 1064, "last_activity_date": 1698743682, "creation_date": 1246197950, "last_edit_date": 1597257494, "question_id": 1054984, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1054984/how-can-i-get-column-names-from-a-table-in-sql-server", "title": "How can I get column names from a table in SQL Server?", "body": "<p>I want to query the name of all columns of a table. I found how to do this in:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/q/452464/419956\">Oracle</a></li>\n<li><a href=\"https://stackoverflow.com/q/193780/419956\">MySQL</a></li>\n<li><a href=\"https://dba.stackexchange.com/q/22362/5089\">PostgreSQL</a></li>\n</ul>\n<p>But I also need to know: <strong>how can this be done in <em>Microsoft SQL Server</em> (2008 in my case)?</strong></p>\n"}, {"tags": ["sql", "sql-server", "database", "sql-server-2008", "azure-sql-database"], "owner": {"account_id": 79135, "reputation": 18963, "user_id": 224636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/030328fbd41e5d7b11fecfc221d71675?s=256&d=identicon&r=PG&f=y&so-version=2", "display_name": "xorpower", "link": "https://stackoverflow.com/users/224636/xorpower"}, "is_answered": true, "view_count": 1812373, "protected_date": 1674591812, "accepted_answer_id": 21824729, "answer_count": 26, "score": 1047, "last_activity_date": 1717627733, "creation_date": 1392627108, "last_edit_date": 1468511280, "question_id": 21824478, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/21824478/reset-identity-seed-after-deleting-records-in-sql-server", "title": "Reset identity seed after deleting records in SQL Server", "body": "<p>I have inserted records into a SQL Server database table. The table had a primary key defined and the auto increment identity seed is set to \u201cYes\u201d. This is done primarily because in SQL Azure, each table has to have a primary key and identity defined. </p>\n\n<p>But since I have to delete some records from the table, the identity seed for those tables will be disturbed and the index column (which is auto-generated with an increment of 1) will get disturbed.</p>\n\n<p><strong>How can I reset the identity column after I deleted the records so that the column has sequence in ascending numerical order?</strong></p>\n\n<p>The identity column is not used as a foreign key anywhere in database.</p>\n"}, {"tags": ["sql", "select", "contains"], "owner": {"account_id": 1117158, "reputation": 14741, "user_id": 1106247, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.sstatic.net/upOkK.png?s=256", "display_name": "Mario", "link": "https://stackoverflow.com/users/1106247/mario"}, "is_answered": true, "view_count": 4679066, "protected_date": 1520265204, "accepted_answer_id": 14290878, "answer_count": 15, "score": 1032, "last_activity_date": 1687352550, "creation_date": 1357971590, "last_edit_date": 1685526534, "question_id": 14290857, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/14290857/sql-select-where-field-contains-words", "title": "SQL SELECT WHERE field contains words", "body": "<p>I need a select which would return results like this:</p>\n\n<pre><code>SELECT * FROM MyTable WHERE Column1 CONTAINS 'word1 word2 word3'\n</code></pre>\n\n<p>And I need all results, i.e. this includes strings with 'word2 word3 word1' or 'word1 word3 word2' or any other combination of the three.</p>\n\n<p>All words need to be in the result.</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "stored-procedures", "sql-function"], "owner": {"account_id": 19219, "reputation": 81711, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.sstatic.net/JbQbc.jpg?s=256", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "is_answered": true, "view_count": 812311, "protected_date": 1328105452, "accepted_answer_id": 1179778, "answer_count": 19, "score": 1013, "last_activity_date": 1719686620, "creation_date": 1248464406, "last_edit_date": 1673308356, "question_id": 1179758, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1179758/function-vs-stored-procedure-in-sql-server", "title": "Function vs. Stored Procedure in SQL Server", "body": "<p>When should I use a function rather than a stored procedure in SQL, and vice versa? What is the purpose of each?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql"], "owner": {"account_id": 22812, "reputation": 25676, "user_id": 56679, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/433ce421a358d55b9f2982008f645336?s=256&d=identicon&r=PG", "display_name": "chillitom", "link": "https://stackoverflow.com/users/56679/chillitom"}, "is_answered": true, "view_count": 1023988, "protected_date": 1393064872, "accepted_answer_id": 12956348, "answer_count": 32, "score": 1006, "last_activity_date": 1700822567, "creation_date": 1233058679, "last_edit_date": 1416678186, "question_id": 483193, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/483193/how-can-i-list-all-foreign-keys-referencing-a-given-table-in-sql-server", "title": "How can I list all foreign keys referencing a given table in SQL Server?", "body": "<p>I need to remove a highly referenced table in a SQL Server database.  How can I get a list of all the foreign key constraints I will need to remove in order to drop the table?</p>\n\n<p>(SQL answers preferable over clicking about in the GUI of the management studio.)</p>\n"}, {"tags": ["sql", "join", "where-clause", "on-clause"], "owner": {"account_id": 1012, "reputation": 78506, "user_id": 1343, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6757caf55de0413ae0994293e001d465?s=256&d=identicon&r=PG", "display_name": "BCS", "link": "https://stackoverflow.com/users/1343/bcs"}, "is_answered": true, "view_count": 1055508, "protected_date": 1638566333, "accepted_answer_id": 354094, "answer_count": 22, "score": 985, "last_activity_date": 1732029842, "creation_date": 1228853692, "last_edit_date": 1704051612, "question_id": 354070, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/354070/sql-join-what-is-the-difference-between-where-clause-and-on-clause", "title": "SQL JOIN: what is the difference between WHERE clause and ON clause?", "body": "<p>What is the difference and what should go in each?</p>\n<p>If I understand the theory correctly, the query optimizer should be able to use both interchangeably.</p>\n<p>(Note: this question is <em>not</em> a duplicate of <a href=\"https://stackoverflow.com/questions/44917/explicit-vs-implicit-sql-joins\">Explicit vs Implicit SQL Joins</a>.\nThe answer may be related (or even the same) but the <strong>question</strong> is different.)</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "sql-server-2000"], "owner": {"account_id": 7281, "reputation": 256581, "user_id": 12597, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4b534325156758d6592fb624d7b60e22?s=256&d=identicon&r=PG", "display_name": "Ian Boyd", "link": "https://stackoverflow.com/users/12597/ian-boyd"}, "is_answered": true, "view_count": 887088, "accepted_answer_id": 2043290, "answer_count": 11, "score": 958, "last_activity_date": 1725718636, "creation_date": 1263228277, "last_edit_date": 1590881096, "question_id": 2043259, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/2043259/how-to-join-to-first-row", "title": "How to Join to first row", "body": "<p>I'll use a concrete, but hypothetical, example.</p>\n\n<p>Each <strong>Order</strong> normally has only one <strong>line item</strong>:</p>\n\n<p><strong>Orders:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>OrderGUID   OrderNumber\n=========   ============\n{FFB2...}   STL-7442-1      \n{3EC6...}   MPT-9931-8A\n</code></pre>\n\n<p><strong>LineItems:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>LineItemGUID   Order ID Quantity   Description\n============   ======== ========   =================================\n{098FBE3...}   1        7          prefabulated amulite\n{1609B09...}   2        32         spurving bearing\n</code></pre>\n\n<p>But occasionally there will be an order with two line items:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>LineItemID   Order ID    Quantity   Description\n==========   ========    ========   =================================\n{A58A1...}   6,784,329   5          pentametric fan\n{0E9BC...}   6,784,329   5          differential girdlespring \n</code></pre>\n\n<p>Normally when showing the orders to the user:</p>\n\n\n\n<pre><code>SELECT Orders.OrderNumber, LineItems.Quantity, LineItems.Description\nFROM Orders\n    INNER JOIN LineItems \n    ON Orders.OrderID = LineItems.OrderID\n</code></pre>\n\n<p>I want to show the single item on the order. But with this occasional order containing two (or more) items, the orders would <em>appear</em> be <strong>duplicated</strong>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>OrderNumber   Quantity   Description\n===========   ========   ====================\nSTL-7442-1    7          prefabulated amulite\nMPT-9931-8A   32         spurving bearing\nKSG-0619-81   5          panametric fan\nKSG-0619-81   5          differential girdlespring\n</code></pre>\n\n<p>What I really want is to have SQL Server <em>just pick one</em>, as it will be <em>good enough</em>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>OrderNumber   Quantity   Description\n===========   ========   ====================\nSTL-7442-1    7          prefabulated amulite\nMPT-9931-8A   32         differential girdlespring\nKSG-0619-81   5          panametric fan\n</code></pre>\n\n<p>If I get adventurous, I might show the user, an ellipsis to indicate that there's more than one:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>OrderNumber   Quantity   Description\n===========   ========   ====================\nSTL-7442-1    7          prefabulated amulite\nMPT-9931-8A   32         differential girdlespring\nKSG-0619-81   5          panametric fan, ...\n</code></pre>\n\n<p>So the question is how to either</p>\n\n<ul>\n<li>eliminate \"duplicate\" rows</li>\n<li>only join to one of the rows, to avoid duplication</li>\n</ul>\n\n<h2>First attempt</h2>\n\n<p>My first naive attempt was to only join to the \"<strong>TOP 1</strong>\" line items:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT Orders.OrderNumber, LineItems.Quantity, LineItems.Description\nFROM Orders\n    INNER JOIN (\n       SELECT TOP 1 LineItems.Quantity, LineItems.Description\n       FROM LineItems\n       WHERE LineItems.OrderID = Orders.OrderID) LineItems2\n    ON 1=1\n</code></pre>\n\n<p>But that gives the error:</p>\n\n<blockquote>\n  <p>The column or prefix 'Orders' does not<br>\n  match with a table name or alias name<br>\n  used in the query.  </p>\n</blockquote>\n\n<p>Presumably because the inner select doesn't see the outer table.</p>\n"}, {"tags": ["sql", "sorting", "sql-order-by", "multiple-columns"], "owner": {"account_id": 41964, "reputation": 16896, "user_id": 122105, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.sstatic.net/0yuXL.png?s=256", "display_name": "Se&#241;or Reginold Francis", "link": "https://stackoverflow.com/users/122105/se%c3%b1or-reginold-francis"}, "is_answered": true, "view_count": 1451584, "accepted_answer_id": 2051176, "answer_count": 9, "score": 946, "last_activity_date": 1687953633, "creation_date": 1263319329, "last_edit_date": 1687953633, "question_id": 2051162, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/2051162/sql-multiple-column-ordering", "title": "SQL multiple column ordering", "body": "<p>How can I sort multiple columns in SQL and in different directions? For instance,  'column1' would be sorted descendingly and 'column2' ascendingly.</p>\n"}, {"tags": ["mysql", "sql", "max", "distinct", "greatest-n-per-group"], "owner": {"account_id": 876228, "reputation": 9891, "user_id": 73810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f0146de538a2e082639ef8669209d68f?s=256&d=identicon&r=PG", "display_name": "Kaptah", "link": "https://stackoverflow.com/users/73810/kaptah"}, "is_answered": true, "view_count": 1909416, "protected_date": 1311333726, "accepted_answer_id": 612268, "answer_count": 22, "score": 919, "last_activity_date": 1702676426, "creation_date": 1236197666, "last_edit_date": 1652227159, "question_id": 612231, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/612231/how-can-i-select-rows-with-maxcolumn-value-partition-by-another-column-in-mys", "title": "How can I SELECT rows with MAX(Column value), PARTITION by another column in MYSQL?", "body": "<p>I have a table of player performance:</p>\n<pre><code>CREATE TABLE TopTen (\n  id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,\n  home INT UNSIGNED NOT NULL,\n  `datetime`DATETIME NOT NULL,\n  player VARCHAR(6) NOT NULL,\n  resource INT NOT NULL\n);\n</code></pre>\n<p>What query will return the rows for each distinct <code>home</code> holding its maximum value of <code>datetime</code>? In other words, how can I filter by the maximum <code>datetime</code> (grouped by <code>home</code>) and still include other non-grouped, non-aggregate columns (such as <code>player</code>) in the result?</p>\n<p>For this sample data:</p>\n<pre><code>INSERT INTO TopTen\n  (id, home, `datetime`, player, resource)\nVALUES\n  (1, 10, '04/03/2009', 'john', 399),\n  (2, 11, '04/03/2009', 'juliet', 244),\n  (5, 12, '04/03/2009', 'borat', 555),\n  (3, 10, '03/03/2009', 'john', 300),\n  (4, 11, '03/03/2009', 'juliet', 200),\n  (6, 12, '03/03/2009', 'borat', 500),\n  (7, 13, '24/12/2008', 'borat', 600),\n  (8, 13, '01/01/2009', 'borat', 700)\n;\n</code></pre>\n<p>the result should be:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>home</th>\n<th>datetime</th>\n<th>player</th>\n<th>resource</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>10</td>\n<td>04/03/2009</td>\n<td>john</td>\n<td>399</td>\n</tr>\n<tr>\n<td>2</td>\n<td>11</td>\n<td>04/03/2009</td>\n<td>juliet</td>\n<td>244</td>\n</tr>\n<tr>\n<td>5</td>\n<td>12</td>\n<td>04/03/2009</td>\n<td>borat</td>\n<td>555</td>\n</tr>\n<tr>\n<td>8</td>\n<td>13</td>\n<td>01/01/2009</td>\n<td>borat</td>\n<td>700</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I tried a subquery getting the maximum <code>datetime</code> for each <code>home</code>:</p>\n<pre><code>-- 1 ..by the MySQL manual: \n\nSELECT DISTINCT\n  home,\n  id,\n  datetime AS dt,\n  player,\n  resource\nFROM TopTen t1\nWHERE `datetime` = (SELECT\n  MAX(t2.datetime)\nFROM TopTen t2\nGROUP BY home)\nGROUP BY `datetime`\nORDER BY `datetime` DESC\n</code></pre>\n<p>The result-set has 130 rows although database holds 187, indicating the result includes some duplicates of <code>home</code>.</p>\n<p>Then I tried joining to a subquery that gets the maximum <code>datetime</code> for each row <code>id</code>:</p>\n<pre><code>-- 2 ..join\n\nSELECT\n  s1.id,\n  s1.home,\n  s1.datetime,\n  s1.player,\n  s1.resource\nFROM TopTen s1\nJOIN (SELECT\n  id,\n  MAX(`datetime`) AS dt\nFROM TopTen\nGROUP BY id) AS s2\n  ON s1.id = s2.id\nORDER BY `datetime`\n</code></pre>\n<p>Nope. Gives all the records.</p>\n<p>I tried various exotic queries, each with various results, but nothing that got me any closer to solving this problem.</p>\n"}, {"tags": ["sql", "sql-server", "t-sql"], "owner": {"account_id": 22378, "reputation": 20792, "user_id": 55102, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/deaf44d9ea52c4112ffb155bf0b86ac3?s=256&d=identicon&r=PG", "display_name": "Bob The Janitor", "link": "https://stackoverflow.com/users/55102/bob-the-janitor"}, "is_answered": true, "view_count": 1234766, "protected_date": 1421941292, "accepted_answer_id": 723317, "answer_count": 14, "score": 912, "last_activity_date": 1691556943, "creation_date": 1239051375, "last_edit_date": 1522057736, "question_id": 723195, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/723195/should-i-use-or-for-not-equal-in-t-sql", "title": "Should I use != or &lt;&gt; for not equal in T-SQL?", "body": "<p>I have seen <code>SQL</code> that uses both <code>!=</code> and <code>&lt;&gt;</code> for <strong><em>not equal</em></strong>. What is the preferred syntax and why?</p>\n\n<p>I like <code>!=</code>, because <code>&lt;&gt;</code> reminds me of <code>Visual Basic</code>.</p>\n"}, {"tags": ["sql", "mysql", "join", "outer-join", "full-outer-join"], "owner": {"account_id": 196687, "reputation": 22370, "user_id": 440266, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9334ecc8e9546620050e8b208f139f37?s=256&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/440266/spencer"}, "is_answered": true, "view_count": 1167821, "protected_date": 1409501904, "accepted_answer_id": 4796911, "answer_count": 14, "score": 902, "last_activity_date": 1715394756, "creation_date": 1295976858, "last_edit_date": 1628373989, "question_id": 4796872, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/4796872/how-can-i-do-a-full-outer-join-in-mysql", "title": "How can I do a FULL OUTER JOIN in MySQL?", "body": "<p>I want to do a <em><a href=\"https://en.wikipedia.org/wiki/Join_(SQL)#Full_outer_join\" rel=\"noreferrer\">full outer join</a></em> in MySQL. Is this possible? Is a <em>full outer join</em> supported by MySQL?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "datetime", "datetime2"], "owner": {"account_id": 53129, "reputation": 10749, "user_id": 158801, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.sstatic.net/aLr4R.png?s=256", "display_name": "Mikeon", "link": "https://stackoverflow.com/users/158801/mikeon"}, "is_answered": true, "view_count": 692068, "protected_date": 1457639963, "accepted_answer_id": 1884088, "answer_count": 17, "score": 901, "last_activity_date": 1696518812, "creation_date": 1251287110, "last_edit_date": 1490037950, "question_id": 1334143, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/1334143/datetime2-vs-datetime-in-sql-server", "title": "DateTime2 vs DateTime in SQL Server", "body": "<p>Which one: </p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/ms187819.aspx\" rel=\"noreferrer\"><code>datetime</code></a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/bb677335.aspx\" rel=\"noreferrer\"><code>datetime2</code></a></li>\n</ul>\n\n<p>is <em>the</em> recommended way to store date and time in SQL Server 2008+?</p>\n\n<p>I'm aware of differences in precision (and storage space probably), but ignoring those for now, is there a best practice document on when to use what, or maybe we should just use <code>datetime2</code> only?</p>\n"}, {"tags": ["sql", "sql-server", "performance"], "owner": {"account_id": 44674, "reputation": 30101, "user_id": 131238, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b21cc978a1a0c13ea9b12d5b978c0?s=256&d=identicon&r=PG&f=y&so-version=2", "display_name": "super9", "link": "https://stackoverflow.com/users/131238/super9"}, "is_answered": true, "view_count": 553905, "protected_date": 1395338110, "accepted_answer_id": 1221649, "answer_count": 13, "score": 899, "last_activity_date": 1683219176, "creation_date": 1249294510, "last_edit_date": 1578131035, "question_id": 1221559, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1221559/count-vs-count1-sql-server", "title": "Count(*) vs Count(1) - SQL Server", "body": "<p>Just wondering if any of you people use <code>Count(1)</code> over <code>Count(*)</code> and if there is a noticeable difference in performance or if this is just a legacy habit that has been brought forward from days gone past?</p>\n\n<p>The specific database is <code>SQL Server 2005</code>.</p>\n"}, {"tags": ["php", "sql", "laravel", "eloquent", "laravel-query-builder"], "owner": {"account_id": 337315, "reputation": 11687, "user_id": 665518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/85a61bf4c6411ff082c51c5332248dcb?s=256&d=identicon&r=PG", "display_name": "meiryo", "link": "https://stackoverflow.com/users/665518/meiryo"}, "is_answered": true, "view_count": 1416124, "protected_date": 1415252335, "accepted_answer_id": 18236656, "answer_count": 40, "score": 870, "last_activity_date": 1715665011, "creation_date": 1376495034, "last_edit_date": 1640478189, "question_id": 18236294, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/18236294/how-do-i-get-the-query-builder-to-output-its-raw-sql-query-as-a-string", "title": "How do I get the query builder to output its raw SQL query as a string?", "body": "<p>Given the following code:</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>DB::table('users')-&gt;get();\n</code></pre>\n\n<p>I want to get the raw SQL query string that the database query builder above will generate. In this example, it would be <code>SELECT * FROM users</code>.</p>\n\n<p>How do I do this?</p>\n"}, {"tags": ["python", "sql", "mysql", "django", "django-models"], "owner": {"account_id": 128768, "reputation": 37464, "user_id": 326849, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7d9c6fbccb7dfb47cd81f17bf0bd5cc?s=256&d=identicon&r=PG", "display_name": "jul", "link": "https://stackoverflow.com/users/326849/jul"}, "is_answered": true, "view_count": 977846, "protected_date": 1721405856, "accepted_answer_id": 15501754, "answer_count": 9, "score": 854, "last_activity_date": 1720766128, "creation_date": 1363701838, "last_edit_date": 1707127479, "question_id": 15501673, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/15501673/how-can-i-temporarily-disable-a-foreign-key-constraint-in-mysql", "title": "How can I temporarily disable a foreign key constraint in MySQL?", "body": "<p>Is it possible to temporarily disable constraints in MySQL?</p>\n<p>I have two Django models, each with a foreign key to the other one. Deleting instances of a model returns an error because of the foreign key constraint:</p>\n<pre><code>cursor.execute(&quot;DELETE FROM myapp_item WHERE n = %s&quot;, n)\ntransaction.commit_unless_managed()  #a foreign key constraint fails here\n\ncursor.execute(&quot;DELETE FROM myapp_style WHERE n = %s&quot;, n)\ntransaction.commit_unless_managed()\n</code></pre>\n<p>Is it possible to temporarily disable constraints and delete anyway?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "sql-server-2005", "sql-update"], "owner": {"account_id": 17899, "reputation": 218702, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=256&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_answered": true, "view_count": 1204143, "protected_date": 1476207968, "accepted_answer_id": 982947, "answer_count": 13, "score": 831, "last_activity_date": 1709985217, "creation_date": 1244746173, "last_edit_date": 1389147507, "question_id": 982919, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/982919/sql-update-query-using-joins", "title": "SQL update query using joins", "body": "<p>I have to update a field with a value which is returned by a join of 3 tables.</p>\n\n<p>Example: </p>\n\n<pre><code>select\n    im.itemid\n    ,im.sku as iSku\n    ,gm.SKU as GSKU\n    ,mm.ManufacturerId as ManuId\n    ,mm.ManufacturerName\n    ,im.mf_item_number\n    ,mm.ManufacturerID\nfrom \n    item_master im, group_master gm, Manufacturer_Master mm \nwhere\n    im.mf_item_number like 'STA%'\n    and im.sku=gm.sku\n    and gm.ManufacturerID = mm.ManufacturerID\n    and gm.manufacturerID=34\n</code></pre>\n\n<p>I want to update the <code>mf_item_number</code> field values of table <code>item_master</code> with some other value which is joined in the above condition.</p>\n\n<p>How can I do this in MS SQL Server?</p>\n"}, {"tags": ["sql", "sql-server", "sql-server-2008", "alter-table"], "owner": {"account_id": 1366956, "reputation": 9642, "user_id": 1303193, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c9add0b79bfb9bf25550c8b1d53950f7?s=256&d=identicon&r=PG", "display_name": "Serhio g. Lazin", "link": "https://stackoverflow.com/users/1303193/serhio-g-lazin"}, "is_answered": true, "view_count": 1611025, "protected_date": 1393455232, "accepted_answer_id": 16296669, "answer_count": 11, "score": 816, "last_activity_date": 1606061177, "creation_date": 1367314488, "last_edit_date": 1516011059, "question_id": 16296622, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/16296622/rename-column-sql-server-2008", "title": "Rename column SQL Server 2008", "body": "<p>I am using SQL Server 2008 and Navicat. I need to rename a column in a table using SQL.</p>\n\n<pre><code>ALTER TABLE table_name RENAME COLUMN old_name to new_name;\n</code></pre>\n\n<p>This statement doesn't work.</p>\n"}, {"tags": ["c#", "sql", "entity-framework"], "owner": {"account_id": 156462, "reputation": 9610, "user_id": 373768, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7244a48ee00da930c5a22d4cdaab2d4d?s=256&d=identicon&r=PG", "display_name": "Bongo Sharp", "link": "https://stackoverflow.com/users/373768/bongo-sharp"}, "is_answered": true, "view_count": 597690, "protected_date": 1565908768, "accepted_answer_id": 5942176, "answer_count": 31, "score": 816, "last_activity_date": 1688765145, "creation_date": 1304961240, "last_edit_date": 1688765145, "question_id": 5940225, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/5940225/fastest-way-of-inserting-in-entity-framework", "title": "Fastest Way of Inserting in Entity Framework", "body": "<p>I'm looking for the fastest way of inserting in Entity Framework.</p>\n<p>I'm asking this because of the scenario where you have an active <code>TransactionScope</code> and the insertion is huge (4000+). It can potentially last more than 10 minutes (default timeout of transactions), and this will lead to an incomplete transaction.</p>\n"}, {"tags": ["sql", "mysql", "unicode", "character-encoding", "collation"], "owner": {"account_id": 54131, "reputation": 60669, "user_id": 161922, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/16e12e337f6edc3750681492656097ed?s=256&d=identicon&r=PG", "display_name": "Amandasaurus", "link": "https://stackoverflow.com/users/161922/amandasaurus"}, "is_answered": true, "view_count": 872139, "answer_count": 17, "score": 811, "last_activity_date": 1684813798, "creation_date": 1246029740, "last_edit_date": 1684811465, "question_id": 1049728, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1049728/mysql-get-character-set-of-database-or-table-or-column", "title": "MySQL: Get character-set of database or table or column?", "body": "<p>What is the (default) charset for:</p>\n\n<ul>\n<li><p>MySQL database</p></li>\n<li><p>MySQL table</p></li>\n<li><p>MySQL column</p></li>\n</ul>\n"}, {"tags": ["mysql", "sql", "date", "datetime", "group-by"], "owner": {"account_id": 1685, "reputation": 13162, "user_id": 2274, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f18fe189ba44c9592ec230c9fa40ff79?s=256&d=identicon&r=PG", "display_name": "Fernando Barrocal", "link": "https://stackoverflow.com/users/2274/fernando-barrocal"}, "is_answered": true, "view_count": 919397, "accepted_answer_id": 508806, "answer_count": 19, "score": 810, "last_activity_date": 1697101441, "creation_date": 1233692959, "last_edit_date": 1584743100, "question_id": 508791, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/508791/mysql-query-group-by-day-month-year", "title": "MySQL Query GROUP BY day / month / year", "body": "<p>Is it possible to make a simple query to count how many records I have in a determined period of time like a year, month, or day, having a <code>TIMESTAMP</code> field, like: </p>\n\n<pre><code>SELECT COUNT(id)\nFROM stats\nWHERE record_date.YEAR = 2009\nGROUP BY record_date.YEAR\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>SELECT COUNT(id)\nFROM stats\nGROUP BY record_date.YEAR, record_date.MONTH\n</code></pre>\n\n<p>To have a monthly statistic. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["mysql", "sql", "quotes"], "owner": {"account_id": 526014, "reputation": 28344, "user_id": 1101095, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a4a762b99d9cc935b6e2ed091c99050d?s=256&d=identicon&r=PG&f=y&so-version=2", "display_name": "Nate", "link": "https://stackoverflow.com/users/1101095/nate"}, "is_answered": true, "view_count": 330491, "protected_date": 1444035513, "accepted_answer_id": 11321508, "answer_count": 13, "score": 801, "last_activity_date": 1704781862, "creation_date": 1341366816, "last_edit_date": 1704781862, "question_id": 11321491, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/11321491/when-to-use-single-quotes-double-quotes-and-backticks-in-mysql", "title": "When to use single quotes, double quotes, and backticks in MySQL", "body": "<p>I am trying to learn the best way to write queries. I also understand the importance of being consistent. Until now, I have randomly used single quotes, double quotes, and backticks without any real thought.</p>\n<p>Example:</p>\n<pre><code>$query = 'INSERT INTO table (id, col1, col2) VALUES (NULL, val1, val2)';\n</code></pre>\n<p>Also, in the above example, consider that <code>table</code>, <code>col1</code>, <code>val1</code>, etc. may be variables.</p>\n<p>What is the standard for this? What do you do?</p>\n"}, {"tags": ["sql", "postgresql", "quotes", "string-literals"], "owner": {"account_id": 1211479, "reputation": 10163, "user_id": 1179916, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1866588afaa65314c68f0bdb621d9a73?s=256&d=identicon&r=PG", "display_name": "MAHI", "link": "https://stackoverflow.com/users/1179916/mahi"}, "is_answered": true, "view_count": 781353, "accepted_answer_id": 12320729, "answer_count": 8, "score": 796, "last_activity_date": 1678863522, "creation_date": 1347016271, "last_edit_date": 1631768737, "question_id": 12316953, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/12316953/insert-text-with-single-quotes-in-postgresql", "title": "Insert text with single quotes in PostgreSQL", "body": "<p>I have a table <code>test(id,name)</code>.</p>\n\n<p>I need to insert values like:  <code>user's log</code>, <code>'my user'</code>, <code>customer's</code>.</p>\n\n<pre><code> insert into test values (1,'user's log');\n insert into test values (2,''my users'');\n insert into test values (3,'customer's');\n</code></pre>\n\n<p>I am getting an error if I run any of the above statements.</p>\n\n<p>If there is any method to do this correctly please share. I don't want any prepared statements.</p>\n\n<p>Is it possible using sql escaping mechanism?</p>\n"}, {"tags": ["php", "mysql", "sql", "security", "sql-injection"], "owner": {"account_id": 34080, "reputation": 83697, "user_id": 95944, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.sstatic.net/SprKq.jpg?s=256", "display_name": "Richard Knop", "link": "https://stackoverflow.com/users/95944/richard-knop"}, "is_answered": true, "view_count": 320576, "protected_date": 1444036903, "accepted_answer_id": 5741264, "answer_count": 4, "score": 793, "last_activity_date": 1601452526, "creation_date": 1303372571, "last_edit_date": 1559641392, "question_id": 5741187, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/5741187/sql-injection-that-gets-around-mysql-real-escape-string", "title": "SQL injection that gets around mysql_real_escape_string()", "body": "<p>Is there an SQL injection possibility even when using <code>mysql_real_escape_string()</code> function?</p>\n\n<p>Consider this sample situation. SQL is constructed in PHP like this:</p>\n\n<pre><code>$login = mysql_real_escape_string(GetFromPost('login'));\n$password = mysql_real_escape_string(GetFromPost('password'));\n\n$sql = \"SELECT * FROM table WHERE login='$login' AND password='$password'\";\n</code></pre>\n\n<p>I have heard numerous people say to me that code like that is still dangerous and possible to hack even with <code>mysql_real_escape_string()</code> function used. But I cannot think of any possible exploit?</p>\n\n<p>Classic injections like this:</p>\n\n<pre><code>aaa' OR 1=1 --\n</code></pre>\n\n<p>do not work.</p>\n\n<p>Do you know of any possible injection that would get through the PHP code above?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "greatest-n-per-group"], "owner": {"account_id": 374470, "reputation": 30093, "user_id": 724689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.sstatic.net/N2ebu.jpg?s=256", "display_name": "kazinix", "link": "https://stackoverflow.com/users/724689/kazinix"}, "is_answered": true, "view_count": 1033603, "protected_date": 1658408857, "accepted_answer_id": 6841644, "answer_count": 18, "score": 786, "last_activity_date": 1717784018, "creation_date": 1311756076, "last_edit_date": 1707861346, "question_id": 6841605, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/6841605/get-top-1-row-of-each-group", "title": "Get top 1 row of each group", "body": "<p>I have a table which I want to get the latest entry for each group. Here's the table:</p>\n<p><code>DocumentStatusLogs</code> Table</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>ID</th>\n<th>DocumentID</th>\n<th>Status</th>\n<th>DateCreated</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>2</td>\n<td>1</td>\n<td>S1</td>\n<td>7/29/2011</td>\n</tr>\n<tr>\n<td>3</td>\n<td>1</td>\n<td>S2</td>\n<td>7/30/2011</td>\n</tr>\n<tr>\n<td>6</td>\n<td>1</td>\n<td>S1</td>\n<td>8/02/2011</td>\n</tr>\n<tr>\n<td>1</td>\n<td>2</td>\n<td>S1</td>\n<td>7/28/2011</td>\n</tr>\n<tr>\n<td>4</td>\n<td>2</td>\n<td>S2</td>\n<td>7/30/2011</td>\n</tr>\n<tr>\n<td>5</td>\n<td>2</td>\n<td>S3</td>\n<td>8/01/2011</td>\n</tr>\n<tr>\n<td>6</td>\n<td>3</td>\n<td>S1</td>\n<td>8/02/2011</td>\n</tr>\n</tbody>\n</table></div>\n<p>The table will be grouped by <code>DocumentID</code> and sorted by <code>DateCreated</code> in descending order. For each <code>DocumentID</code>, I want to get the latest status.</p>\n<p>My preferred output:</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>DocumentID</th>\n<th>Status</th>\n<th>DateCreated</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>S1</td>\n<td>8/02/2011</td>\n</tr>\n<tr>\n<td>2</td>\n<td>S3</td>\n<td>8/01/2011</td>\n</tr>\n<tr>\n<td>3</td>\n<td>S1</td>\n<td>8/02/2011</td>\n</tr>\n</tbody>\n</table></div>\n<ul>\n<li><p>Is there any aggregate function to get only the top from each group? See pseudo-code <code>GetOnlyTheTop</code> below:</p>\n<pre><code>  SELECT\n    DocumentID,\n    GetOnlyTheTop(Status),\n    GetOnlyTheTop(DateCreated)\n  FROM DocumentStatusLogs\n  GROUP BY DocumentID\n  ORDER BY DateCreated DESC\n</code></pre>\n</li>\n<li><p>If such function doesn't exist, is there any way I can achieve the output I want?</p>\n</li>\n<li><p>Or at the first place, could this be caused by unnormalized database? I'm thinking, since what I'm looking for is just one row, should that <code>status</code> also be located in the parent table?</p>\n</li>\n</ul>\n<p>Please see the parent table for more information:</p>\n<p>Current <code>Documents</code> Table</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>DocumentID</th>\n<th>Title</th>\n<th>Content</th>\n<th>DateCreated</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>TitleA</td>\n<td>...</td>\n<td>...</td>\n</tr>\n<tr>\n<td>2</td>\n<td>TitleB</td>\n<td>...</td>\n<td>...</td>\n</tr>\n<tr>\n<td>3</td>\n<td>TitleC</td>\n<td>...</td>\n<td>...</td>\n</tr>\n</tbody>\n</table></div>\n<p>Should the parent table be like this so that I can easily access its status?</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>DocumentID</th>\n<th>Title</th>\n<th>Content</th>\n<th>DateCreated</th>\n<th>CurrentStatus</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>TitleA</td>\n<td>...</td>\n<td>...</td>\n<td>s1</td>\n</tr>\n<tr>\n<td>2</td>\n<td>TitleB</td>\n<td>...</td>\n<td>...</td>\n<td>s3</td>\n</tr>\n<tr>\n<td>3</td>\n<td>TitleC</td>\n<td>...</td>\n<td>...</td>\n<td>s1</td>\n</tr>\n</tbody>\n</table></div>\n<p><strong>UPDATE</strong>\nI just learned how to use &quot;apply&quot; which makes it easier to address such problems.</p>\n"}, {"tags": ["mysql", "sql", "database"], "owner": {"account_id": 255148, "reputation": 14218, "user_id": 534994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c10bfa58600b422a1462669b898d3ad7?s=256&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/534994/michael"}, "is_answered": true, "view_count": 1600508, "protected_date": 1395125293, "accepted_answer_id": 5951204, "answer_count": 8, "score": 771, "last_activity_date": 1715234961, "creation_date": 1305035611, "last_edit_date": 1442351973, "question_id": 5951157, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/5951157/if-in-select-statement-choose-output-value-based-on-column-values", "title": "&#39;IF&#39; in &#39;SELECT&#39; statement - choose output value based on column values", "body": "<pre><code>SELECT id, amount FROM report\n</code></pre>\n\n<p>I need <code>amount</code> to be <code>amount</code> if <code>report.type='P'</code> and <code>-amount</code> if <code>report.type='N'</code>. How do I add this to the above query?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql"], "owner": {"account_id": 13872, "reputation": 17608, "user_id": 28098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d774a899d468f1230cf492cc1b5805d6?s=256&d=identicon&r=PG", "display_name": "z-boss", "link": "https://stackoverflow.com/users/28098/z-boss"}, "is_answered": true, "view_count": 1557007, "protected_date": 1641444486, "accepted_answer_id": 2686266, "answer_count": 16, "score": 763, "last_activity_date": 1725040629, "creation_date": 1271881105, "last_edit_date": 1375192282, "question_id": 2686254, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/2686254/how-to-select-all-records-from-one-table-that-do-not-exist-in-another-table", "title": "How to select all records from one table that do not exist in another table?", "body": "<blockquote>\n  <p>table1 (id, name)<br>\n  table2 (id, name)</p>\n</blockquote>\n\n<p>Query:</p>\n\n<pre><code>SELECT name   \nFROM table2  \n-- that are not in table1 already\n</code></pre>\n"}, {"tags": ["sql", "mysql", "database", "privileges", "sql-grant"], "owner": {"account_id": 567999, "reputation": 7617, "user_id": 207008, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/58a1659d8dbe6bda1017e480061d92ea?s=256&d=identicon&r=PG", "display_name": "jimgh", "link": "https://stackoverflow.com/users/207008/jimgh"}, "is_answered": true, "view_count": 956998, "protected_date": 1361812225, "answer_count": 10, "score": 760, "last_activity_date": 1699637139, "creation_date": 1258006231, "last_edit_date": 1697913356, "question_id": 1720244, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1720244/create-new-user-in-mysql-and-give-it-full-access-to-one-database", "title": "Create new user in MySQL and give it full access to one database", "body": "<p>I want to create a new user in MySQL and give it full access only to one database, say <code>dbTest</code> that I create with a command like <code>create database dbTest;</code>. What would be the MySQL commands to do that?</p>\n"}, {"tags": ["sql", "postgresql", "primary-key", "ddl", "database-sequence"], "owner": {"account_id": 2957, "reputation": 33240, "user_id": 4196, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.sstatic.net/HFhzV.jpg?s=256", "display_name": "meleyal", "link": "https://stackoverflow.com/users/4196/meleyal"}, "is_answered": true, "view_count": 470554, "protected_date": 1603243473, "accepted_answer_id": 244265, "answer_count": 36, "score": 750, "last_activity_date": 1723411620, "creation_date": 1225217301, "last_edit_date": 1660960861, "question_id": 244243, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/244243/how-to-reset-postgres-primary-key-sequence-when-it-falls-out-of-sync", "title": "How to reset Postgres&#39; primary key sequence when it falls out of sync?", "body": "<p>I ran into the problem that my primary key sequence is not in sync with my table rows. </p>\n\n<p>That is, when I insert a new row I get a duplicate key error because the sequence implied in the serial datatype returns a number that already exists.</p>\n\n<p>It seems to be caused by import/restores not maintaining the sequence properly.</p>\n"}, {"tags": ["sql", "database", "postgresql", "alter", "superuser"], "owner": {"account_id": 1074883, "reputation": 10854, "user_id": 1073252, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/af4c9d4d5de75d90da65ed97bcedba30?s=256&d=identicon&r=PG", "display_name": "flossfan", "link": "https://stackoverflow.com/users/1073252/flossfan"}, "is_answered": true, "view_count": 450362, "accepted_answer_id": 10757486, "answer_count": 12, "score": 748, "last_activity_date": 1698051735, "creation_date": 1337960598, "last_edit_date": 1697039811, "question_id": 10757431, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/10757431/postgres-upgrade-a-user-to-be-a-superuser", "title": "Postgres: upgrade a user to be a superuser?", "body": "<p>In postgres, how do I change an existing user to be a superuser? I don't want to delete the existing user, for various reasons. </p>\n\n<pre><code># alter user myuser ...?\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "database", "insert", "upsert"], "owner": {"account_id": 10095, "reputation": 30151, "user_id": 18907, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a3a443f340c0985d7cf43188145a1384?s=256&d=identicon&r=PG", "display_name": "Chris Cudmore", "link": "https://stackoverflow.com/users/18907/chris-cudmore"}, "is_answered": true, "view_count": 962652, "protected_date": 1553132546, "accepted_answer_id": 108420, "answer_count": 21, "score": 744, "last_activity_date": 1662453254, "creation_date": 1221922847, "last_edit_date": 1397053025, "question_id": 108403, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/108403/solutions-for-insert-or-update-on-sql-server", "title": "Solutions for INSERT OR UPDATE on SQL Server", "body": "<p>Assume a table structure of <code>MyTable(KEY, datafield1, datafield2...)</code>.</p>\n\n<p>Often I want to either update an existing record, or insert a new record if it doesn't exist.</p>\n\n<p>Essentially:</p>\n\n<pre><code>IF (key exists)\n  run update command\nELSE\n  run insert command\n</code></pre>\n\n<p>What's the best performing way to write this?</p>\n"}, {"tags": ["sql", "sql-server", "line-breaks"], "owner": {"account_id": 968, "reputation": 33471, "user_id": 1284, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ed7dec07c571e2c32e8aa536ad31dca3?s=256&d=identicon&r=PG", "display_name": "Mark Struzinski", "link": "https://stackoverflow.com/users/1284/mark-struzinski"}, "is_answered": true, "view_count": 1534427, "protected_date": 1477908924, "accepted_answer_id": 31063, "answer_count": 12, "score": 713, "last_activity_date": 1726163506, "creation_date": 1219866781, "last_edit_date": 1373483936, "question_id": 31057, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/31057/how-to-insert-a-line-break-in-a-sql-server-varchar-nvarchar-string", "title": "How to insert a line break in a SQL Server VARCHAR/NVARCHAR string", "body": "<p>I didn't see any similar questions asked on this topic, and I had to research this for something I'm working on right now. Thought I would post the answer for it in case anyone else had the same question.</p>\n"}, {"tags": ["mysql", "sql", "database"], "owner": {"account_id": 69, "reputation": 57323, "user_id": 83, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a27764e5c0529d03018cba073e612c3a?s=256&d=identicon&r=PG", "display_name": "Zack Peterson", "link": "https://stackoverflow.com/users/83/zack-peterson"}, "is_answered": true, "view_count": 1145107, "protected_date": 1310055842, "accepted_answer_id": 105798, "answer_count": 19, "score": 690, "last_activity_date": 1728847211, "creation_date": 1221859620, "last_edit_date": 1529225154, "question_id": 105776, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/105776/how-do-i-restore-a-dump-file-from-mysqldump", "title": "How do I restore a dump file from mysqldump?", "body": "<p>I was given a MySQL database file that I need to restore as a database on my Windows Server 2008 machine.</p>\n\n<p>I tried using MySQL Administrator, but I got the following error:</p>\n\n<blockquote>\n  <p>The selected file was generated by\n  mysqldump and cannot be restored by\n  this application.</p>\n</blockquote>\n\n<p>How do I get this working?</p>\n"}, {"tags": ["sql", "mysql", "database", "dump", "database-dump"], "owner": {"account_id": 3853, "reputation": 1009, "user_id": 5630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3fd93c6894b219905b98ae06e064649?s=256&d=identicon&r=PG", "display_name": "Zac", "link": "https://stackoverflow.com/users/5630/zac"}, "is_answered": true, "view_count": 475497, "accepted_answer_id": 425172, "answer_count": 13, "community_owned_date": 1231435817, "score": 688, "last_activity_date": 1720822444, "creation_date": 1231435817, "last_edit_date": 1699221369, "question_id": 425158, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/425158/how-to-skip-certain-database-tables-with-mysqldump", "title": "How to skip certain database tables with mysqldump?", "body": "<p>Is there a way to restrict certain tables from the mysqldump command?</p>\n<p>For example, I'd use the following syntax to dump <em>only</em> <code>table1</code> and <code>table2</code>:</p>\n<pre class=\"lang-none prettyprint-override\"><code>mysqldump -u username -p database table1 table2 &gt; database.sql\n</code></pre>\n<p>But is there a similar way to dump all the tables <em>except</em> <code>table1</code> and <code>table2</code>? I haven't found anything in the mysqldump documentation, so is brute-force (specifying all the table names) the only way to go?</p>\n"}, {"tags": ["sql", "mysql", "database", "database-schema", "dump"], "owner": {"account_id": 392607, "reputation": 9745, "user_id": 753983, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ca7328249a82be501edf1b996ebefb53?s=256&d=identicon&r=PG", "display_name": "Darth Blue Ray", "link": "https://stackoverflow.com/users/753983/darth-blue-ray"}, "is_answered": true, "view_count": 581274, "accepted_answer_id": 6175506, "answer_count": 16, "score": 682, "last_activity_date": 1701436880, "creation_date": 1306753614, "last_edit_date": 1701436880, "question_id": 6175473, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/6175473/export-schema-without-data", "title": "Export schema without data", "body": "<p>I'm using a MySql database with a Java program, now I want to give the program to somebody else.</p>\n<p>How to export the MySQL database structure without the data in it, just the structure?</p>\n"}, {"tags": ["sql", "oracle-database", "greatest-n-per-group"], "owner": {"account_id": 11052, "reputation": 6845, "user_id": 21154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad98d5e71b9a8801a2b0aba330dd196e?s=256&d=identicon&r=PG", "display_name": "Umang", "link": "https://stackoverflow.com/users/21154/umang"}, "is_answered": true, "view_count": 702114, "protected_date": 1509543982, "accepted_answer_id": 121450, "answer_count": 36, "score": 681, "last_activity_date": 1717752425, "creation_date": 1222180453, "last_edit_date": 1683973919, "question_id": 121387, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/121387/fetch-the-rows-which-have-the-max-value-for-a-column-for-each-distinct-value-of", "title": "Fetch the rows which have the Max value for a column for each distinct value of another column", "body": "<p>Table:</p>\n<pre><code>UserId, Value, Date.\n</code></pre>\n<p>I want to get the UserId, Value for the max(Date) for each UserId. That is, the Value for each UserId that has the latest date.</p>\n<p>How do I do this in SQL? (Preferably Oracle.)</p>\n<p>I need to get ALL the UserIds. But for each UserId, only that row where that user has the latest date.</p>\n"}, {"tags": ["sql", "database", "sqlite", "syntax", "insert"], "owner": {"account_id": 20341, "reputation": 238637, "user_id": 48523, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c787bc735dbe80ec2f88824e1d10c6c?s=256&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/48523/andrew"}, "is_answered": true, "view_count": 537143, "protected_date": 1389107647, "accepted_answer_id": 5009740, "answer_count": 26, "score": 677, "last_activity_date": 1696480708, "creation_date": 1256241882, "last_edit_date": 1696004740, "question_id": 1609637, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1609637/how-to-insert-multiple-rows-in-sqlite", "title": "How to insert multiple rows in SQLite?", "body": "<p>In MySQL you can insert multiple rows like this:</p>\n\n<pre><code>INSERT INTO 'tablename' ('column1', 'column2') VALUES\n    ('data1', 'data2'),\n    ('data1', 'data2'),\n    ('data1', 'data2'),\n    ('data1', 'data2');\n</code></pre>\n\n<p>However, I am getting an error when I try to do something like this. Is it possible to insert multiple rows at a time in an SQLite database? What is the syntax to do that?</p>\n"}, {"tags": ["sql", "sql-server", "max"], "owner": {"account_id": 7989, "reputation": 31084, "user_id": 14101, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/166240152218bde8121c53a8d891b85d?s=256&d=identicon&r=PG", "display_name": "skb", "link": "https://stackoverflow.com/users/14101/skb"}, "is_answered": true, "view_count": 701235, "protected_date": 1390508955, "accepted_answer_id": 124474, "answer_count": 31, "score": 649, "last_activity_date": 1675738911, "creation_date": 1222210323, "last_edit_date": 1309434389, "question_id": 124417, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/124417/is-there-a-max-function-in-sql-server-that-takes-two-values-like-math-max-in-ne", "title": "Is there a Max function in SQL Server that takes two values like Math.Max in .NET?", "body": "<p>I want to write a query like this:</p>\n\n<pre><code>SELECT o.OrderId, MAX(o.NegotiatedPrice, o.SuggestedPrice)\nFROM Order o\n</code></pre>\n\n<p>But this isn't how the <code>MAX</code> function works, right?  It is an aggregate function so it expects a single parameter and then returns the MAX of all rows.   </p>\n\n<p>Does anyone know how to do it my way?</p>\n"}, {"tags": ["sql", "sql-server", "notin"], "owner": {"account_id": 5954, "reputation": 16352, "user_id": 9825, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/500e9e648f141048942c737fc88f38bd?s=256&d=identicon&r=PG", "display_name": "ilitirit", "link": "https://stackoverflow.com/users/9825/ilitirit"}, "is_answered": true, "view_count": 1939434, "protected_date": 1425936743, "accepted_answer_id": 11074428, "answer_count": 11, "score": 646, "last_activity_date": 1687342819, "creation_date": 1223259545, "last_edit_date": 1353581565, "question_id": 173041, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/173041/not-in-vs-not-exists", "title": "NOT IN vs NOT EXISTS", "body": "<p>Which of these queries is the faster?</p>\n\n<p>NOT EXISTS:</p>\n\n<pre><code>SELECT ProductID, ProductName \nFROM Northwind..Products p\nWHERE NOT EXISTS (\n    SELECT 1 \n    FROM Northwind..[Order Details] od \n    WHERE p.ProductId = od.ProductId)\n</code></pre>\n\n<p>Or NOT IN:</p>\n\n<pre><code>SELECT ProductID, ProductName \nFROM Northwind..Products p\nWHERE p.ProductID NOT IN (\n    SELECT ProductID \n    FROM Northwind..[Order Details])\n</code></pre>\n\n<p>The query execution plan says they both do the same thing.  If that is the case, which is the recommended form?</p>\n\n<p>This is based on the NorthWind database.</p>\n\n<p>[Edit]</p>\n\n<p>Just found this helpful article: \n<a href=\"http://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx\" rel=\"noreferrer\">http://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx</a></p>\n\n<p>I think I'll stick with NOT EXISTS.</p>\n"}, {"tags": ["sql", "sql-server-2008"], "owner": {"account_id": 276293, "reputation": 29533, "user_id": 569654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a571a3bf019dac1837a5a6c7ff86c010?s=256&d=identicon&r=PG", "display_name": "Beginner", "link": "https://stackoverflow.com/users/569654/beginner"}, "is_answered": true, "view_count": 1708499, "protected_date": 1444742700, "accepted_answer_id": 7063527, "answer_count": 7, "score": 643, "last_activity_date": 1591936387, "creation_date": 1313401049, "last_edit_date": 1386607264, "question_id": 7063501, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/7063501/how-to-turn-identity-insert-on-and-off-using-sql-server-2008", "title": "How to turn IDENTITY_INSERT on and off using SQL Server 2008?", "body": "<p>Why am I getting an error doing an insert when <code>IDENTITY_INSERT</code> is set to OFF?  </p>\n\n<p>How do I turn it on properly in SQL Server 2008? Is it by using SQL Server Management Studio?</p>\n\n<p>I have run this query:</p>\n\n<pre><code>SET IDENTITY_INSERT Database. dbo. Baskets ON\n</code></pre>\n\n<p>Then I got the message back in the console that the Command(s) completed successfully.\nHowever when I run the application, it still gives me the error shown below:</p>\n\n<pre><code>Cannot insert explicit value for identity column in table 'Baskets' when \nIDENTITY_INSERT is set to OFF.\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "t-sql", "sql-server-2005", "distinct"], "owner": {"account_id": 21844, "reputation": 6924, "user_id": 53409, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ab95139721a8d9b463a7b47bcad7a5b3?s=256&d=identicon&r=PG", "display_name": "somacore", "link": "https://stackoverflow.com/users/53409/somacore"}, "is_answered": true, "view_count": 1787432, "protected_date": 1513668631, "accepted_answer_id": 1521656, "answer_count": 7, "score": 639, "last_activity_date": 1715770943, "creation_date": 1254766756, "last_edit_date": 1705672715, "question_id": 1521605, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/1521605/selecting-count-with-distinct", "title": "Selecting COUNT(*) with DISTINCT", "body": "<p>In SQL Server 2005 I have a table <code>cm_production</code> that lists all the code that's been put into production. The table has a <code>ticket_number</code>, <code>program_type</code>, <code>program_name</code> and <code>push_number</code> along with some other columns.</p>\n<p>GOAL: Count all the DISTINCT program names by program type and push number.</p>\n<p>What I have so far is:</p>\n<pre><code>DECLARE @push_number INT;\nSET @push_number = [HERE_ADD_NUMBER];\n\nSELECT DISTINCT COUNT(*) AS Count, program_type AS [Type] \nFROM cm_production \nWHERE push_number=@push_number \nGROUP BY program_type\n</code></pre>\n<p>This gets me partway there, but it's counting all the program names, not the distinct ones (which I don't expect it to do in that query). I guess I just can't wrap my head around how to tell it to count only the distinct program names without selecting them. Or something.</p>\n"}, {"tags": ["sql", "database", "sqlite", "select", "database-table"], "owner": {"account_id": 22365, "reputation": 6881, "user_id": 55061, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/32c37abe8570fd46e2f5e69b7a4d4c97?s=256&d=identicon&r=PG", "display_name": "luebken", "link": "https://stackoverflow.com/users/55061/luebken"}, "is_answered": true, "view_count": 863120, "answer_count": 25, "score": 633, "last_activity_date": 1695970849, "creation_date": 1244062754, "last_edit_date": 1654159657, "question_id": 947215, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/947215/how-to-get-a-list-of-column-names-on-sqlite3-database", "title": "How to get a list of column names on Sqlite3 database?", "body": "<p>I want to migrate my iPhone app to a new database version. Since I don't have some version saved, I need to check if certain column names exist.</p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/685206/sqlite-how-to-get-a-list-of-column-names\">Stackoverflow entry</a> suggests doing the select</p>\n\n<pre><code>SELECT sql FROM sqlite_master\nWHERE tbl_name = 'table_name' AND type = 'table'\n</code></pre>\n\n<p>and parse the result. </p>\n\n<p>Is that the common way? Alternatives?</p>\n"}, {"tags": ["sql", "sqlite", "upsert"], "owner": {"account_id": 10018, "reputation": 8704, "user_id": 18749, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6eac75cc74c34eecd873c34305e1c052?s=256&d=identicon&r=PG", "display_name": "Mike Trader", "link": "https://stackoverflow.com/users/18749/mike-trader"}, "is_answered": true, "view_count": 397431, "protected_date": 1553132530, "accepted_answer_id": 4330694, "answer_count": 19, "score": 629, "last_activity_date": 1680861986, "creation_date": 1231292843, "last_edit_date": 1680861986, "question_id": 418898, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/418898/upsert-not-insert-or-replace", "title": "UPSERT *not* INSERT or REPLACE", "body": "<p><a href=\"http://en.wikipedia.org/wiki/Upsert\" rel=\"noreferrer\">http://en.wikipedia.org/wiki/Upsert</a></p>\n<p><a href=\"https://stackoverflow.com/questions/13540/insert-update-stored-proc-on-sql-server\">Insert Update stored proc on SQL Server</a></p>\n<p>Is there some clever way to do this in SQLite that I have not thought of?</p>\n<p>Basically I want to update three out of four columns if the record exists. If it does not exist, I want to INSERT the record with the default (NULL) value for the fourth column.</p>\n<p>The ID is a primary key, so there will only ever be one record to UPSERT.</p>\n<p>(I am trying to avoid the overhead of SELECT in order to determine if I need to UPDATE or INSERT obviously)</p>\n<p>Suggestions?</p>\n<hr />\n<p>I cannot confirm that syntax on the SQLite site for TABLE CREATE.\nI have not built a demo to test it, but it doesn't seem to be supported.</p>\n<p>If it was, I have three columns so it would actually look like:</p>\n<pre><code>CREATE TABLE table1( \n    id INTEGER PRIMARY KEY ON CONFLICT REPLACE, \n    Blob1 BLOB ON CONFLICT REPLACE, \n    Blob2 BLOB ON CONFLICT REPLACE, \n    Blob3 BLOB \n);\n</code></pre>\n<p>but the first two blobs will not cause a conflict, only the ID would\nSo I assume Blob1 and Blob2 would not be replaced (as desired)</p>\n<hr />\n<p>UPDATEs in SQLite when binding data are a complete transaction, meaning\nEach sent row to be updated requires:  Prepare/Bind/Step/Finalize statements unlike the INSERT which allows the use of the reset function</p>\n<p>The life of a statement object goes something like this:</p>\n<ol>\n<li>Create the object using sqlite3_prepare_v2()</li>\n<li>Bind values to host parameters using sqlite3_bind_ interfaces.</li>\n<li>Run the SQL by calling sqlite3_step()</li>\n<li>Reset the statement using sqlite3_reset() then go back to step 2 and repeat.</li>\n<li>Destroy the statement object using sqlite3_finalize().</li>\n</ol>\n<p>UPDATE I am guessing is slow compared to INSERT, but how does it compare to SELECT using the Primary key?</p>\n<p>Perhaps I should use the select to read the 4th column (Blob3) and then use REPLACE to write a new record blending the original 4th Column with the new data for the first 3 columns?</p>\n"}, {"tags": ["sql", "sql-server", "string", "sql-server-2008", "replace"], "owner": {"account_id": 2981983, "reputation": 6833, "user_id": 2531765, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.sstatic.net/W381w.jpg?s=256", "display_name": "aston_zh", "link": "https://stackoverflow.com/users/2531765/aston-zh"}, "is_answered": true, "view_count": 1349866, "protected_date": 1516838200, "accepted_answer_id": 17365278, "answer_count": 9, "score": 627, "last_activity_date": 1643631113, "creation_date": 1372424107, "last_edit_date": 1442610540, "question_id": 17365222, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/17365222/update-and-replace-part-of-a-string", "title": "UPDATE and REPLACE part of a string", "body": "<p>I've got a table with two columns, <code>ID</code> and <code>Value</code>. I want to change a part of some strings in the second column.</p>\n\n<p>Example of Table:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ID            Value\n---------------------------------\n1             c:\\temp\\123\\abc\\111\n2             c:\\temp\\123\\abc\\222\n3             c:\\temp\\123\\abc\\333\n4             c:\\temp\\123\\abc\\444\n</code></pre>\n\n<p>Now the <code>123\\</code> in the <code>Value</code> string is not needed. I tried <code>UPDATE</code> and <code>REPLACE</code>:</p>\n\n<pre><code>UPDATE dbo.xxx\nSET Value = REPLACE(Value, '%123%', '')\nWHERE ID &lt;= 4\n</code></pre>\n\n<p>When I execute the script SQL Server does not report an error, but it does not update anything either. Why is that?</p>\n"}, {"tags": ["sql", "random"], "owner": {"account_id": 376, "reputation": 16840, "user_id": 473, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7fbd6be0fb0acd878c35d5c49c485933?s=256&d=identicon&r=PG", "display_name": "sverrejoh", "link": "https://stackoverflow.com/users/473/sverrejoh"}, "is_answered": true, "view_count": 605921, "protected_date": 1556774537, "accepted_answer_id": 19419, "answer_count": 32, "score": 618, "last_activity_date": 1706340226, "creation_date": 1219300129, "last_edit_date": 1682719864, "question_id": 19412, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/19412/how-to-request-a-random-row-in-sql", "title": "How to request a random row in SQL?", "body": "<p>How can I request a random row (or as close to truly random as possible) in pure SQL?</p>\n"}, {"tags": ["sql", "mysql"], "owner": {"account_id": 28175, "reputation": 11316, "user_id": 74980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.sstatic.net/e1Yx5.jpg?s=256", "display_name": "GeekJock", "link": "https://stackoverflow.com/users/74980/geekjock"}, "is_answered": true, "view_count": 444832, "accepted_answer_id": 4192849, "answer_count": 14, "score": 612, "last_activity_date": 1717969936, "creation_date": 1237254245, "last_edit_date": 1717969936, "question_id": 652770, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/652770/delete-with-join-in-mysql", "title": "Delete with Join in MySQL", "body": "<p>Here is the script to create my tables: </p>\n\n<pre><code>CREATE TABLE clients (\n   client_i INT(11),\n   PRIMARY KEY (client_id)\n);\nCREATE TABLE projects (\n   project_id INT(11) UNSIGNED,\n   client_id INT(11) UNSIGNED,\n   PRIMARY KEY (project_id)\n);\nCREATE TABLE posts (\n   post_id INT(11) UNSIGNED,\n   project_id INT(11) UNSIGNED,\n   PRIMARY KEY (post_id)\n);\n</code></pre>\n\n<p>In my PHP code, when deleting a client, I want to delete all projects posts:</p>\n\n<pre><code>DELETE \nFROM posts\nINNER JOIN projects ON projects.project_id = posts.project_id\nWHERE projects.client_id = :client_id;\n</code></pre>\n\n<p>The posts table does not have a foreign key <code>client_id</code>, only <code>project_id</code>. I want to delete the posts in projects that have the passed <code>client_id</code>.</p>\n\n<p>This is not working right now because no posts are deleted.</p>\n"}, {"tags": ["sql", "sql-server", "performance", "pagination"], "owner": {"account_id": 10279, "reputation": 11050, "user_id": 19331, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/17458e75f191bb53e8a69aeb72a4a189?s=256&d=identicon&r=PG", "display_name": "Panagiotis Korros", "link": "https://stackoverflow.com/users/19331/panagiotis-korros"}, "is_answered": true, "view_count": 717074, "protected_date": 1565755997, "accepted_answer_id": 109290, "answer_count": 19, "score": 611, "last_activity_date": 1688554949, "creation_date": 1221941778, "last_edit_date": 1382811620, "question_id": 109232, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/109232/what-is-the-best-way-to-paginate-results-in-sql-server", "title": "What is the best way to paginate results in SQL Server", "body": "<p>What is the best way (performance wise) to paginate results in SQL Server 2000, 2005, 2008, 2012 if you also want to get the total number of results (before paginating)?</p>\n"}, {"tags": ["sql", "sql-server", "t-sql", "case"], "owner": {"account_id": 651902, "reputation": 6215, "user_id": 455195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/aa2ff5c65c67b5d5a10d7fe969a00f36?s=256&d=identicon&r=PG", "display_name": "Werner", "link": "https://stackoverflow.com/users/455195/werner"}, "is_answered": true, "view_count": 3107964, "protected_date": 1486754442, "accepted_answer_id": 5487936, "answer_count": 10, "score": 610, "last_activity_date": 1714456063, "creation_date": 1301496311, "last_edit_date": 1714456063, "question_id": 5487892, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/5487892/or-is-not-supported-with-case-expression-sql-server", "title": "OR is not supported with CASE expression SQL Server", "body": "<p>The <code>OR</code> operator in the <code>WHEN</code> clause of a <code>CASE</code> expression is not supported. How can I do this?</p>\n<pre><code>CASE ebv.db_no \n    WHEN 22978 OR 23218 OR 23219 THEN 'WECS 9500' \n    ELSE 'WECS 9520' \nEND as wecs_system \n</code></pre>\n"}, {"tags": ["sql", "sql-server", "t-sql", "datetime", "date"], "owner": {"account_id": 48565, "reputation": 6773, "user_id": 144355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b72e7f826e11589d694993c6619b98?s=256&d=identicon&r=PG", "display_name": "Stephen Perelson", "link": "https://stackoverflow.com/users/144355/stephen-perelson"}, "is_answered": true, "view_count": 1025665, "protected_date": 1411623433, "accepted_answer_id": 1177529, "answer_count": 24, "score": 610, "last_activity_date": 1726156635, "creation_date": 1248439794, "last_edit_date": 1310453509, "question_id": 1177449, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/1177449/best-approach-to-remove-time-part-of-datetime-in-sql-server", "title": "Best approach to remove time part of datetime in SQL Server", "body": "<p>Which method provides the best performance when removing the time portion from a datetime field in SQL Server?</p>\n\n<pre><code>a) select DATEADD(dd, DATEDIFF(dd, 0, getdate()), 0)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>b) select cast(convert(char(11), getdate(), 113) as datetime)\n</code></pre>\n\n<p>The second method does send a few more bytes either way but that might not be as important as the speed of the conversion.</p>\n\n<p>Both also appear to be very fast, but there might be a difference in speed when dealing with hundreds-of-thousands or more rows?</p>\n\n<p>Also, is it possible that there are even better methods to get rid of the time portion of a datetime in SQL?</p>\n"}, {"tags": ["sql", "sql-server-2008", "duplicates", "sql-delete"], "owner": {"account_id": 240632, "reputation": 11407, "user_id": 510981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c67916d7ae0085a7bb06940e026207e8?s=256&d=identicon&r=PG", "display_name": "Fearghal", "link": "https://stackoverflow.com/users/510981/fearghal"}, "is_answered": true, "view_count": 1501655, "protected_date": 1456727352, "answer_count": 30, "score": 607, "last_activity_date": 1733555681, "creation_date": 1377204674, "last_edit_date": 1711003592, "question_id": 18390574, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/18390574/delete-duplicate-rows-keeping-the-first-row", "title": "Delete duplicate rows keeping the first row", "body": "<p>How can I <strong>delete duplicate rows</strong> where no <code>unique row id</code> exists?</p>\n\n<p>My table is</p>\n\n<pre><code>col1  col2 col3 col4 col5 col6 col7\njohn  1    1    1    1    1    1 \njohn  1    1    1    1    1    1\nsally 2    2    2    2    2    2\nsally 2    2    2    2    2    2\n</code></pre>\n\n<p>I want to be left with the following after the duplicate removal:</p>\n\n<pre><code>john  1    1    1    1    1    1\nsally 2    2    2    2    2    2\n</code></pre>\n\n<p>I've tried a few queries but I think they depend on having a row id as I don't get the desired result. For example:</p>\n\n<pre><code>DELETE\nFROM table\nWHERE col1 IN (\n    SELECT id\n    FROM table\n    GROUP BY id\n    HAVING (COUNT(col1) &gt; 1)\n)\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "sql-update", "duplicates", "distinct"], "owner": {"account_id": 3407, "reputation": 34652, "user_id": 4915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26f97db02c772f7ab7e5630824794bae?s=256&d=identicon&r=PG", "display_name": "sheats", "link": "https://stackoverflow.com/users/4915/sheats"}, "is_answered": true, "view_count": 1386396, "accepted_answer_id": 54430, "answer_count": 5, "score": 607, "last_activity_date": 1729309702, "creation_date": 1221060790, "last_edit_date": 1408666048, "question_id": 54418, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/54418/how-do-i-or-can-i-select-distinct-on-multiple-columns", "title": "How do I (or can I) SELECT DISTINCT on multiple columns?", "body": "<p>I need to retrieve all rows from a table where 2 columns combined are all different. So I want all the sales that do not have any other sales that happened on the same day for the same price. The sales that are unique based on day and price will get updated to an active status.</p>\n\n<p>So I'm thinking:</p>\n\n<pre><code>UPDATE sales\nSET status = 'ACTIVE'\nWHERE id IN (SELECT DISTINCT (saleprice, saledate), id, count(id)\n             FROM sales\n             HAVING count = 1)\n</code></pre>\n\n<p>But my brain hurts going any farther than that.</p>\n"}, {"tags": ["mysql", "sql"], "owner": {"account_id": 337344, "reputation": 25701, "user_id": 665557, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/10b31574b457051a4f033e149a10da81?s=256&d=identicon&r=PG", "display_name": "cdub", "link": "https://stackoverflow.com/users/665557/cdub"}, "is_answered": true, "view_count": 1163570, "accepted_answer_id": 11754790, "answer_count": 9, "score": 606, "last_activity_date": 1727778330, "creation_date": 1343807272, "last_edit_date": 1479786173, "question_id": 11754781, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/11754781/how-to-declare-a-variable-in-mysql", "title": "How to declare a variable in MySQL?", "body": "<p>How to declare a variable in mysql, so that my second query can use it?</p>\n\n<p>I would like to write something like:</p>\n\n<pre><code>SET start = 1;\nSET finish = 10;\n\nSELECT * FROM places WHERE place BETWEEN start AND finish;\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "t-sql"], "owner": {"account_id": 18005, "reputation": 15345, "user_id": 40872, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.sstatic.net/eDBIz.jpg?s=256", "display_name": "agnieszka", "link": "https://stackoverflow.com/users/40872/agnieszka"}, "is_answered": true, "view_count": 893765, "accepted_answer_id": 1400115, "answer_count": 13, "score": 604, "last_activity_date": 1671185004, "creation_date": 1252506532, "last_edit_date": 1518818296, "question_id": 1400078, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/1400078/is-it-possible-to-specify-condition-in-count", "title": "Is it possible to specify condition in Count()?", "body": "<p>Is it possible to specify a condition in <code>Count()</code>? I would like to count only the rows that have, for example, \"Manager\" in the Position column.</p>\n\n<p>I want to do it in the count statement, not using <code>WHERE</code>; I'm asking about it because I need to count both Managers and Other in the same <code>SELECT</code> (something like <code>Count(Position = Manager), Count(Position = Other))</code> so <code>WHERE</code> is no use for me in this example.</p>\n"}, {"tags": ["sql", "algorithm", "recursion", "tree", "hierarchical-data"], "owner": {"account_id": 10030, "reputation": 338128, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=256&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_answered": true, "view_count": 143279, "protected_date": 1409043187, "accepted_answer_id": 192462, "answer_count": 15, "score": 580, "last_activity_date": 1705939105, "creation_date": 1223657263, "last_edit_date": 1495541898, "question_id": 192220, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/192220/what-is-the-most-efficient-elegant-way-to-parse-a-flat-table-into-a-tree", "title": "What is the most efficient/elegant way to parse a flat table into a tree?", "body": "<p>Assume you have a flat table that stores an ordered tree hierarchy:</p>\n\n<pre><code>Id   Name         ParentId   Order\n 1   'Node 1'            0      10\n 2   'Node 1.1'          1      10\n 3   'Node 2'            0      20\n 4   'Node 1.1.1'        2      10\n 5   'Node 2.1'          3      10\n 6   'Node 1.2'          1      20\n</code></pre>\n\n<p>Here's a diagram, where we have <code>[id] Name</code>.  Root node 0 is fictional.</p>\n\n<pre>\n                       [0] ROOT\n                          /    \\ \n              [1] Node 1          [3] Node 2\n              /       \\                   \\\n    [2] Node 1.1     [6] Node 1.2      [5] Node 2.1\n          /          \n [4] Node 1.1.1\n</pre>\n\n<p>What minimalistic approach would you use to output that to HTML (or text, for that matter) as a correctly ordered, correctly indented tree? </p>\n\n<p>Assume further you only have basic data structures (arrays and hashmaps), no fancy objects with parent/children references, no ORM, no framework, just your two hands. The table is represented as a result set, which can be accessed randomly. </p>\n\n<p>Pseudo code or plain English is okay, this is purely a conceptional question.</p>\n\n<p>Bonus question: Is there a fundamentally better way to store a tree structure like this in a RDBMS?</p>\n\n<hr>\n\n<p><strong>EDITS AND ADDITIONS</strong></p>\n\n<p>To answer one commenter's (<a href=\"https://stackoverflow.com/users/17826/mark-bessey\">Mark Bessey</a>'s) question: A root node is not necessary, because it is never going to be displayed anyway. ParentId = 0 is the convention to express \"these are top level\". The Order column defines how nodes with the same parent are going to be sorted.</p>\n\n<p>The \"result set\" I spoke of can be pictured as an array of hashmaps (to stay in that terminology). For my example was meant to be already there. Some answers go the extra mile and construct it first, but thats okay.</p>\n\n<p>The tree can be arbitrarily deep. Each node can have N children. I did not exactly have a \"millions of entries\" tree in mind, though.</p>\n\n<p>Don't mistake my choice of node naming ('Node 1.1.1') for something to rely on. The nodes could equally well be called 'Frank' or 'Bob', no naming structure is implied, this was merely to make it readable.</p>\n\n<p><em>I have posted my own solution so you guys can pull it to pieces.</em></p>\n"}, {"tags": ["sql", "mysql", "database-connection"], "owner": {"account_id": 8822035, "reputation": 6011, "user_id": 6591743, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ywJolzX_2Oo/AAAAAAAAAAI/AAAAAAAADmo/tWC31rfzIWY/photo.jpg?sz=256", "display_name": "Harsh Trivedi", "link": "https://stackoverflow.com/users/6591743/harsh-trivedi"}, "is_answered": true, "view_count": 2170885, "protected_date": 1518160237, "closed_date": 1718637075, "accepted_answer_id": 41793945, "answer_count": 29, "score": 577, "last_activity_date": 1716967534, "creation_date": 1484352409, "last_edit_date": 1716967534, "question_id": 41645309, "link": "https://stackoverflow.com/questions/41645309/mysql-error-access-denied-for-user-rootlocalhost", "closed_reason": "Not suitable for this site", "title": "MySQL Error: : &#39;Access denied for user &#39;root&#39;@&#39;localhost&#39;", "body": "<p>Consider:</p>\n<pre><code>./mysqladmin -u root -p** '_redacted_'  \n</code></pre>\n<p>Output (including typing the password):</p>\n<blockquote>\n<p>Enter password:</p>\n<p>mysqladmin: connect to server at 'localhost' failed error:<br />\n<strong>'Access denied for user 'root'@'localhost' (using password: YES)'</strong></p>\n</blockquote>\n<p>How can I fix this?</p>\n"}, {"tags": ["sql", "sql-server", "alter-table", "identity-column"], "owner": {"account_id": 8657, "reputation": 14868, "user_id": 15691, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb7b10f292a0375c3758199f673cca2?s=256&d=identicon&r=PG", "display_name": "Kirschstein", "link": "https://stackoverflow.com/users/15691/kirschstein"}, "is_answered": true, "view_count": 1425751, "protected_date": 1498137702, "accepted_answer_id": 1049305, "answer_count": 21, "score": 576, "last_activity_date": 1701222609, "creation_date": 1246023681, "last_edit_date": 1314058531, "question_id": 1049210, "content_license": "CC BY-SA 3.0", "link": "https://stackoverflow.com/questions/1049210/adding-an-identity-to-an-existing-column", "title": "Adding an identity to an existing column", "body": "<p>I need to change the primary key of a table to an identity column, and there's already a number of rows in table. </p>\n\n<p>I've got a script to clean up the IDs to ensure they're sequential starting at 1, works fine on my test database. </p>\n\n<p>What's the SQL command to alter the column to have an identity property?</p>\n"}, {"tags": ["sql", "postgresql", "postgresql-9.2"], "owner": {"account_id": 2468623, "reputation": 6644, "user_id": 2151087, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/d94716cf8b5f1dd4f3487de368251c72?s=256&d=identicon&r=PG", "display_name": "S M Shamimul Hasan", "link": "https://stackoverflow.com/users/2151087/s-m-shamimul-hasan"}, "is_answered": true, "view_count": 557061, "answer_count": 14, "score": 573, "last_activity_date": 1725367380, "creation_date": 1379636543, "last_edit_date": 1594430136, "question_id": 18907047, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/18907047/postgres-db-size-command", "title": "Postgres DB Size Command", "body": "<p>What is the command to find the size of <em>all</em> the databases?</p>\n<p>I am able to find the size of a <em>specific</em> database by using following command:</p>\n<pre><code>select pg_database_size('databaseName');\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "subquery", "sql-update"], "owner": {"account_id": 267096, "reputation": 6925, "user_id": 555064, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f053e0317f1720c22e257529cf4e9917?s=256&d=identicon&r=PG", "display_name": "stackover", "link": "https://stackoverflow.com/users/555064/stackover"}, "is_answered": true, "view_count": 766924, "accepted_answer_id": 6258586, "answer_count": 8, "score": 572, "last_activity_date": 1687281529, "creation_date": 1307386142, "last_edit_date": 1673310570, "question_id": 6256610, "content_license": "CC BY-SA 4.0", "link": "https://stackoverflow.com/questions/6256610/updating-table-rows-in-postgres-using-subquery", "title": "updating table rows in postgres using subquery", "body": "<p>I have this table in a postgres 8.4 database:</p>\n<pre><code>CREATE TABLE public.dummy\n(\n  address_id SERIAL,\n  addr1 character(40),\n  addr2 character(40),\n  city character(25),\n  state character(2),\n  zip character(5),\n  customer boolean,\n  supplier boolean,\n  partner boolean\n  \n)\nWITH (\n  OIDS=FALSE\n);\n</code></pre>\n<p>I want to update the table. Initially i tested my query using this <code>insert</code> statement:</p>\n<pre><code>insert into address customer,supplier,partner\nSELECT  \n    case when cust.addr1 is not null then TRUE else FALSE end customer, \n    case when suppl.addr1 is not null then TRUE else FALSE end supplier,\n    case when partn.addr1 is not null then TRUE else FALSE end partner\nfrom (\n    SELECT *\n        from address) pa\n    left outer join cust_original cust\n        on (pa.addr1=cust.addr1 and pa.addr2=cust.addr2 and pa.city=cust.city \n            and pa.state=cust.state and substring(cust.zip,1,5) = pa.zip  )\n    left outer join supp_original suppl \n        on (pa.addr1=suppl.addr1 and pa.addr2=suppl.addr2 and pa.city=suppl.city \n                and pa.state=suppl.state and pa.zip = substring(suppl.zip,1,5))\n    left outer join partner_original partn\n        on (pa.addr1=partn.addr1 and pa.addr2=partn.addr2 and pa.city=partn.city\n                  and pa.state=partn.state and pa.zip = substring(partn.zip,1,5) )\nwhere pa.address_id = address_id\n</code></pre>\n<p>How can I convert this to an <code>update</code> statement, i.e., update existing rows using values returned from a <code>select</code> statement?</p>\n"}, {"tags": ["java", "sql", "datetime", "date", "jdbc"], "owner": {"account_id": 24717, "reputation": 273452, "user_id": 63051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b4b87a82355f286bb410cc1854389226?s=256&d=identicon&r=PG", "display_name": "flybywire", "link": "https://stackoverflow.com/users/63051/flybywire"}, "is_answered": true, "view_count": 314148, "accepted_answer_id": 2306051, "answer_count": 7, "score": 563, "last_activity_date": 1726790012, "creation_date": 1266758200, "last_edit_date": 1291744607, "question_id": 2305973, "content_license": "CC BY-SA 2.5", "link": "https://stackoverflow.com/questions/2305973/java-util-date-vs-java-sql-date", "title": "java.util.Date vs java.sql.Date", "body": "<p><code>java.util.Date</code> vs <code>java.sql.Date</code>: when to use which and why?</p>\n"}], "has_more": true, "quota_max": 300, "quota_remaining": 298}